var Ve=Object.defineProperty;var Ne=(K,o,t)=>o in K?Ve(K,o,{enumerable:!0,configurable:!0,writable:!0,value:t}):K[o]=t;var fe=(K,o,t)=>Ne(K,typeof o!="symbol"?o+"":o,t);import{_ as ce,I as E}from"./_plugin-vue_export-helper-CxedO80g.js";import{d as re,c,o as i,e,t as s,f as ve,r as R,x as ne,g as ae,h as _e,i as C,u as n,b as N,q as T,w as j,v as J,F as Y,j as W,p as oe,C as Ee,a as ie,z as Z,T as Ce,D as Pe,E as Te,s as ye,B as ke,G as Be,k as Fe,H as Re,I as Ae}from"./index-hVKh47Ob.js";import{L as De}from"./index-ByYYd1M1.js";const Le={class:"switch"},Ie=["checked"],Oe={class:"switch-label"},qe=re({__name:"index",props:{enabled:{type:Boolean},label:{}},emits:["update:switchValue"],setup(K,{emit:o}){const t=o,m=b=>{const p=b.target.checked;t("update:switchValue",p)};return(b,p)=>(i(),c("label",Le,[e("input",{type:"checkbox",checked:b.enabled,onChange:m},null,40,Ie),p[0]||(p[0]=e("span",{class:"slider"},null,-1)),e("span",Oe,s(b.label),1)]))}}),je=ce(qe,[["__scopeId","data-v-d484b4a3"]]);class he{static async getConfigsByGroup(o){try{const t=await fetch(`${this.BASE_URL}/group/${o}`);if(!t.ok)throw new Error(`Failed to get ${o} group configuration: ${t.status}`);return await t.json()}catch(t){throw console.error(`Failed to get ${o} group configuration:`,t),t}}static async batchUpdateConfigs(o){if(o.length===0)return{success:!0,message:"No configuration needs to be updated"};try{const t=await fetch(`${this.BASE_URL}/batch-update`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});if(!t.ok)throw new Error(`Batch update configuration failed: ${t.status}`);return{success:!0,message:"Configuration saved successfully"}}catch(t){return console.error("Batch update configuration failed:",t),{success:!1,message:t instanceof Error?t.message:"Update failed, please try again"}}}static async getConfigById(o){try{const t=await fetch(`${this.BASE_URL}/${o}`);if(!t.ok)throw new Error(`Failed to get configuration item: ${t.status}`);return await t.json()}catch(t){throw console.error(`Failed to get configuration item[${o}]:`,t),t}}static async updateConfig(o){try{const t=await fetch(`${this.BASE_URL}/${o.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});if(!t.ok)throw new Error(`Failed to update configuration item: ${t.status}`);return{success:!0,message:"Configuration updated successfully"}}catch(t){return console.error("Failed to update configuration item:",t),{success:!1,message:t instanceof Error?t.message:"Update failed, please try again"}}}}fe(he,"BASE_URL","/api/config");const Ge={class:"config-panel"},Ke={class:"config-header"},Je={class:"header-left"},ze={class:"config-stats"},He={class:"stat-item"},Xe={class:"stat-value"},Ye={key:0,class:"stat-item"},We={class:"stat-value modified"},Qe={class:"header-right"},Ze={class:"import-export-actions"},eo={class:"action-btn",title:"导入配置"},oo={class:"search-box"},to=["placeholder"],so={key:0,class:"loading-container"},no={key:1,class:"config-groups"},ao={class:"group-header"},lo={class:"group-info"},io={class:"group-icon"},co={class:"group-actions"},ro=["onClick","disabled","title"],uo={class:"sub-groups"},po=["onClick"],go={class:"sub-group-info"},fo={class:"sub-group-title"},mo={class:"item-count"},vo={class:"config-items"},ho={key:0,class:"config-item-content vertical-layout"},yo={class:"config-item-info"},_o={class:"config-item-header"},bo={class:"config-label"},$o={class:"type-badge boolean"},Co={key:0,class:"modified-badge"},wo=["title"],ko={class:"config-control"},So=["value","onChange"],To=["value"],Ao={key:1,class:"config-item-content vertical-layout"},xo={class:"config-item-info"},Eo={class:"config-item-header"},Mo={class:"config-label"},Uo={class:"type-badge select"},Vo={key:0,class:"modified-badge"},No=["title"],Po={class:"config-control"},Bo=["value","onChange"],Fo=["value"],Ro={key:2,class:"config-item-content vertical-layout"},Do={class:"config-item-info"},Lo={class:"config-item-header"},Io={class:"config-label"},Oo={class:"type-badge textarea"},qo={key:0,class:"modified-badge"},jo=["title"],Go={class:"config-control"},Ko=["value","onInput"],Jo={key:3,class:"config-item-content vertical-layout"},zo={class:"config-item-info"},Ho={class:"config-item-header"},Xo={class:"config-label"},Yo={class:"type-badge number"},Wo={key:0,class:"modified-badge"},Qo=["title"],Zo={key:0,class:"config-meta"},et={class:"range-info"},ot={class:"config-control"},tt=["value","onInput","min","max"],st={key:4,class:"config-item-content vertical-layout"},nt={class:"config-item-info"},at={class:"config-item-header"},lt={class:"config-label"},it={class:"type-badge string"},ct={key:0,class:"modified-badge"},rt=["title"],dt={class:"config-control"},ut=["value","onInput"],pt={key:2,class:"empty-state"},gt=re({__name:"basicConfig",setup(K){const{t:o}=ve(),t=R(!0),m=R(!1),b=R([]),p=R(new Map),d=R(new Set),h=ne({show:!1,text:"",type:"success"}),M=R(""),V={maxSteps:"智能体执行最大步数",resetAllAgents:"重置所有agent",maxMemory:"能记住的最大消息数",headlessBrowser:"是否使用无头浏览器模式",browserTimeout:o("config.basicConfig.browserTimeout"),browserDebug:"浏览器debug模式",autoOpenBrowser:"启动时自动打开浏览器",consoleInteractive:"启用控制台交互模式",systemName:"系统名称",language:"默认语言",maxThreads:"最大线程数",timeoutSeconds:o("config.basicConfig.requestTimeout")},w={manus:"智能体设置",browser:"浏览器设置",interaction:"交互设置",system:"系统设置",performance:"性能设置"},U={manus:"🤖",browser:"🌐",interaction:"🖥️",system:"⚙️",performance:"⚡"},z={agent:"智能体设置",browser:"浏览器设置",interaction:"交互设置",system:"系统设置",performance:"性能设置",general:"常规设置"},Q=ae(()=>b.value.some(r=>r.subGroups.some(_=>_.items.some(k=>p.value.get(k.id)!==k.configValue)))),te=r=>r==="true",L=r=>parseFloat(r)||0,v=r=>({maxSteps:1,browserTimeout:1,maxThreads:1,timeoutSeconds:5,maxMemory:1})[r]||1,q=r=>({maxSteps:100,browserTimeout:600,maxThreads:32,timeoutSeconds:300,maxMemory:1e3})[r]||1e4,F=r=>typeof r=="string"?r:r.value,g=r=>typeof r=="string"?r:r.label,P=(r,_)=>{if(typeof _=="boolean")return _.toString();if(typeof _=="string"){if(r.options&&r.options.length>0){const k=r.options.find(S=>(typeof S=="string"?S:S.label)===_||(typeof S=="string"?S:S.value)===_);if(k)return typeof k=="string"?k:k.value}return _}return String(_)},x=(r,_,k=!1)=>{let S;r.inputType==="BOOLEAN"||r.inputType==="CHECKBOX"?S=P(r,_):S=String(_),r.configValue!==S&&(r.configValue=S,r._modified=!0,(k||r.inputType==="BOOLEAN"||r.inputType==="CHECKBOX"||r.inputType==="SELECT")&&l())};let a=null;const l=()=>{a&&clearTimeout(a),a=window.setTimeout(()=>{I()},500)},y=(r,_="success")=>{h.text=r,h.type=_,h.show=!0,setTimeout(()=>{h.show=!1},3e3)},O=async()=>{try{t.value=!0;const _=["manus","browser","interaction","system","performance"].map(async S=>{try{const u=await he.getConfigsByGroup(S);if(u.length===0)return null;const B=u.map(H=>({...H,displayName:H.description??(V[H.configKey]||H.configKey),min:v(H.configKey),max:q(H.configKey)}));B.forEach(H=>{p.value.set(H.id,H.configValue)});const D=new Map;B.forEach(H=>{const le=H.configSubGroup??"general";D.has(le)||D.set(le,[]),D.get(le).push(H)});const ee=Array.from(D.entries()).map(([H,le])=>({name:H,displayName:z[H]||H,items:le}));return{name:S,displayName:w[S]||S,subGroups:ee}}catch(u){return console.warn(`加载配置组 ${S} 失败，跳过:`,u),null}}),k=await Promise.all(_);b.value=k.filter(S=>S!==null),console.log("配置加载完成:",b.value)}catch(r){console.error("加载配置失败:",r),y(o("config.basicConfig.loadConfigFailed"),"error")}finally{t.value=!1}},I=async()=>{if(!(m.value||!Q.value))try{m.value=!0;const r=[];if(b.value.forEach(k=>{k.subGroups.forEach(S=>{const u=S.items.filter(B=>B._modified);r.push(...u)})}),r.length===0){y("没有需要保存的修改");return}const _=await he.batchUpdateConfigs(r);_.success?(r.forEach(k=>{p.value.set(k.id,k.configValue),k._modified=!1}),y("配置保存成功")):y(_.message||"保存失败","error")}catch(r){console.error("保存配置失败:",r),y(o("config.basicConfig.saveFailed"),"error")}finally{m.value=!1}},X=async r=>{if(confirm(`确定要重置 "${w[r]||r}" 组的所有配置吗？`))try{m.value=!0;const k=b.value.find(B=>B.name===r);if(!k)return;const S=[];if(k.subGroups.forEach(B=>{B.items.forEach(D=>{const ee=se(D.configKey);ee!==D.configValue&&S.push({...D,configValue:ee})})}),S.length===0){y("该组配置已是默认值");return}const u=await he.batchUpdateConfigs(S);u.success?(await O(),y(`成功重置 ${S.length} 项配置`)):y(u.message||"重置失败","error")}catch(k){console.error("重置组配置失败:",k),y(o("config.basicConfig.resetFailed"),"error")}finally{m.value=!1}},se=r=>({systemName:"JTaskPilot",language:"zh-CN",maxThreads:"8",timeoutSeconds:"60",autoOpenBrowser:"false",headlessBrowser:"true",maxMemory:"1000"})[r]||"",be=(r,_)=>{const k=`${r}-${_}`;d.value.has(k)?d.value.delete(k):d.value.add(k)},ge=(r,_)=>d.value.has(`${r}-${_}`),A=ae(()=>{const r=b.value.reduce((k,S)=>k+S.subGroups.reduce((u,B)=>u+B.items.length,0),0),_=b.value.reduce((k,S)=>k+S.subGroups.reduce((u,B)=>u+B.items.filter(D=>p.value.get(D.id)!==D.configValue).length,0),0);return{total:r,modified:_}}),f=ae(()=>{if(!M.value.trim())return b.value;const r=M.value.toLowerCase();return b.value.map(_=>({..._,subGroups:_.subGroups.map(k=>({...k,items:k.items.filter(S=>S.displayName.toLowerCase().includes(r)||S.configKey.toLowerCase().includes(r)||S.description&&S.description.toLowerCase().includes(r))})).filter(k=>k.items.length>0)})).filter(_=>_.subGroups.length>0)}),G=()=>{try{const r={timestamp:new Date().toISOString(),version:"1.0",configs:b.value.reduce((u,B)=>(B.subGroups.forEach(D=>{D.items.forEach(ee=>{u[ee.configKey]=ee.configValue})}),u),{})},_=JSON.stringify(r,null,2),k=new Blob([_],{type:"application/json"}),S=document.createElement("a");S.href=URL.createObjectURL(k),S.download=`config-export-${new Date().toISOString().split("T")[0]}.json`,S.click(),y("配置导出成功")}catch(r){console.error("导出配置失败:",r),y("导出失败","error")}},$=r=>{var u;const _=r.target,k=(u=_.files)==null?void 0:u[0];if(!k)return;const S=new FileReader;S.onload=async B=>{var D;try{const ee=JSON.parse((D=B.target)==null?void 0:D.result);if(!ee.configs)throw new Error("无效的配置文件格式");if(!confirm("确定要导入配置吗？这将覆盖当前配置。"))return;m.value=!0;const le=[];if(b.value.forEach(Me=>{Me.subGroups.forEach(Ue=>{Ue.items.forEach(we=>{Object.prototype.hasOwnProperty.call(ee.configs,we.configKey)&&le.push({...we,configValue:ee.configs[we.configKey]})})})}),le.length===0){y("没有找到可导入的配置项");return}const Se=await he.batchUpdateConfigs(le);Se.success?(await O(),y(`成功导入 ${le.length} 项配置`)):y(Se.message||"导入失败","error")}catch(ee){console.error("导入配置失败:",ee),y(o("config.basicConfig.importFailed"),"error")}finally{m.value=!1,_.value=""}},S.readAsText(k)};return _e(()=>{O()}),(r,_)=>(i(),c("div",Ge,[e("div",Ke,[e("div",Je,[e("h2",null,s(n(o)("config.basicConfig.title")),1),e("div",ze,[e("span",He,[_[1]||(_[1]=e("span",{class:"stat-label"},"总配置项:",-1)),e("span",Xe,s(A.value.total),1)]),A.value.modified>0?(i(),c("span",Ye,[_[2]||(_[2]=e("span",{class:"stat-label"},"已修改:",-1)),e("span",We,s(A.value.modified),1)])):N("",!0)])]),e("div",Qe,[e("div",Ze,[e("button",{onClick:G,class:"action-btn",title:"导出配置"}," 📤 "),e("label",eo,[_[3]||(_[3]=T(" 📥 ")),e("input",{type:"file",accept:".json",onChange:$,style:{display:"none"}},null,32)])]),e("div",oo,[j(e("input",{"onUpdate:modelValue":_[0]||(_[0]=k=>M.value=k),type:"text",placeholder:r.$t("config.search"),class:"search-input"},null,8,to),[[J,M.value]]),_[4]||(_[4]=e("span",{class:"search-icon"},"🔍",-1))])])]),t.value?(i(),c("div",so,[_[5]||(_[5]=e("div",{class:"loading-spinner"},null,-1)),e("p",null,s(r.$t("config.loading")),1)])):f.value.length>0?(i(),c("div",no,[(i(!0),c(Y,null,W(f.value,k=>(i(),c("div",{key:k.name,class:"config-group"},[e("div",ao,[e("div",lo,[e("span",io,s(U[k.name]||"⚙️"),1)]),e("div",co,[e("button",{onClick:S=>X(k.name),class:"reset-btn",disabled:m.value,title:r.$t("config.resetGroupConfirm")},s(r.$t("config.reset")),9,ro)]),_[6]||(_[6]=e("div",{class:"group-divider"},null,-1))]),e("div",uo,[(i(!0),c(Y,null,W(k.subGroups,S=>(i(),c("div",{key:S.name,class:"sub-group"},[e("div",{class:"sub-group-header",onClick:u=>be(k.name,S.name)},[e("div",go,[_[7]||(_[7]=e("span",{class:"sub-group-icon"},"📁",-1)),e("h4",fo,s(S.displayName),1),e("span",mo,"("+s(S.items.length)+")",1)]),e("span",{class:oe(["collapse-icon",{collapsed:ge(k.name,S.name)}])}," ▼ ",2)],8,po),j(e("div",vo,[(i(!0),c(Y,null,W(S.items,u=>(i(),c("div",{key:u.id,class:oe(["config-item",{modified:p.value.get(u.id)!==u.configValue}])},[u.inputType==="BOOLEAN"||u.inputType==="CHECKBOX"?(i(),c("div",ho,[e("div",yo,[e("div",_o,[e("label",bo,[T(s(u.description||u.displayName)+" ",1),e("span",$o,s(u.inputType==="CHECKBOX"?r.$t("config.types.checkbox"):r.$t("config.types.boolean")),1),p.value.get(u.id)!==u.configValue?(i(),c("span",Co,s(r.$t("config.modified")),1)):N("",!0)]),e("span",{class:"config-key",title:u.configKey},s(u.configKey),9,wo)])]),e("div",ko,[u.options&&u.options.length>0?(i(),c("select",{key:0,class:"config-input select-input",value:u.configValue,onChange:B=>{var D;return x(u,((D=B.target)==null?void 0:D.value)||"")}},[(i(!0),c(Y,null,W(u.options,B=>(i(),c("option",{key:F(B),value:F(B)},s(g(B)),9,To))),128))],40,So)):(i(),ie(je,{key:1,enabled:te(u.configValue),label:"","onUpdate:switchValue":B=>x(u,B)},null,8,["enabled","onUpdate:switchValue"]))])])):u.inputType==="SELECT"?(i(),c("div",Ao,[e("div",xo,[e("div",Eo,[e("label",Mo,[T(s(u.description||u.displayName)+" ",1),e("span",Uo,s(r.$t("config.types.select")),1),p.value.get(u.id)!==u.configValue?(i(),c("span",Vo,s(r.$t("config.modified")),1)):N("",!0)]),e("span",{class:"config-key",title:u.configKey},s(u.configKey),9,No)])]),e("div",Po,[e("select",{class:"config-input select-input",value:u.configValue,onChange:B=>{var D;return x(u,((D=B.target)==null?void 0:D.value)||"")}},[(i(!0),c(Y,null,W(u.options||[],B=>(i(),c("option",{key:F(B),value:F(B)},s(g(B)),9,Fo))),128))],40,Bo)])])):u.inputType==="TEXTAREA"?(i(),c("div",Ro,[e("div",Do,[e("div",Lo,[e("label",Io,[T(s(u.description||u.displayName)+" ",1),e("span",Oo,s(r.$t("config.types.textarea")),1),p.value.get(u.id)!==u.configValue?(i(),c("span",qo,s(r.$t("config.modified")),1)):N("",!0)]),e("span",{class:"config-key",title:u.configKey},s(u.configKey),9,jo)])]),e("div",Go,[e("textarea",{class:"config-input textarea-input",value:u.configValue,onInput:B=>{var D;return x(u,((D=B.target)==null?void 0:D.value)||"")},onBlur:l,rows:"3"},null,40,Ko)])])):u.inputType==="NUMBER"?(i(),c("div",Jo,[e("div",zo,[e("div",Ho,[e("label",Xo,[T(s(u.description||u.displayName)+" ",1),e("span",Yo,s(r.$t("config.types.number")),1),p.value.get(u.id)!==u.configValue?(i(),c("span",Wo,s(r.$t("config.modified")),1)):N("",!0)]),e("span",{class:"config-key",title:u.configKey},s(u.configKey),9,Qo),u.min||u.max?(i(),c("div",Zo,[e("span",et,s(r.$t("config.range"))+": "+s(u.min||0)+" - "+s(u.max||"∞"),1)])):N("",!0)])]),e("div",ot,[e("input",{type:"number",class:"config-input number-input",value:L(u.configValue),onInput:B=>{var D;return x(u,((D=B.target)==null?void 0:D.value)||"")},onBlur:l,min:u.min||1,max:u.max||1e4},null,40,tt)])])):(i(),c("div",st,[e("div",nt,[e("div",at,[e("label",lt,[T(s(u.description||u.displayName)+" ",1),e("span",it,s(u.inputType==="TEXT"?r.$t("config.types.text"):r.$t("config.types.string")),1),p.value.get(u.id)!==u.configValue?(i(),c("span",ct,s(r.$t("config.modified")),1)):N("",!0)]),e("span",{class:"config-key",title:u.configKey},s(u.configKey),9,rt)])]),e("div",dt,[e("input",{type:"text",class:"config-input text-input",value:u.configValue,onInput:B=>{var D;return x(u,((D=B.target)==null?void 0:D.value)||"")},onBlur:l},null,40,ut)])]))],2))),128))],512),[[Ee,!ge(k.name,S.name)]])]))),128))])]))),128))])):(i(),c("div",pt,[e("p",null,s(r.$t("config.notFound")),1)])),C(Ce,{name:"message-fade"},{default:Z(()=>[h.show?(i(),c("div",{key:0,class:oe(["message-toast",h.type])},s(h.text),3)):N("",!0)]),_:1})]))}}),ft=ce(gt,[["__scopeId","data-v-99a0498e"]]),mt={class:"modal-header"},vt={class:"modal-content"},ht={class:"modal-footer"},yt=re({__name:"index",props:{modelValue:{type:Boolean,required:!0},title:{type:String,default:""}},emits:["update:modelValue","confirm"],setup(K){const o=t=>{t.target===t.currentTarget&&(t.stopPropagation(),t.preventDefault())};return(t,m)=>(i(),ie(Pe,{to:"body"},[C(Ce,{name:"modal"},{default:Z(()=>[K.modelValue?(i(),c("div",{key:0,class:"modal-overlay",onClick:o},[e("div",{class:"modal-container",onClick:m[3]||(m[3]=ye(()=>{},["stop"]))},[e("div",mt,[e("h3",null,s(K.title),1),e("button",{class:"close-btn",onClick:m[0]||(m[0]=b=>t.$emit("update:modelValue",!1))},[C(n(E),{icon:"carbon:close"})])]),e("div",vt,[Te(t.$slots,"default",{},void 0,!0)]),e("div",ht,[Te(t.$slots,"footer",{},()=>[e("button",{class:"cancel-btn",onClick:m[1]||(m[1]=b=>t.$emit("update:modelValue",!1))},s(t.$t("common.cancel")),1),e("button",{class:"confirm-btn",onClick:m[2]||(m[2]=b=>t.$emit("confirm"))},s(t.$t("common.confirm")),1)],!0)])])])):N("",!0)]),_:3})]))}}),pe=ce(yt,[["__scopeId","data-v-baaf1c89"]]),_t={class:"tool-selection-content"},bt={class:"tool-controls"},$t={class:"search-container"},Ct={class:"sort-container"},wt={class:"tool-summary"},kt={class:"summary-text"},St={key:0,class:"tool-groups"},Tt=["onClick"],At={class:"group-title-area"},xt={class:"group-name"},Et={class:"group-count"},Mt={class:"group-enable-all"},Ut=["checked","onChange","data-group"],Vt={class:"tool-info"},Nt={class:"tool-selection-name"},Pt={key:0,class:"tool-selection-desc"},Bt={class:"tool-actions"},Ft=["checked","onChange"],Rt={key:1,class:"empty-state"},Dt=re({__name:"index",props:{modelValue:{type:Boolean},tools:{},selectedToolIds:{}},emits:["update:modelValue","confirm"],setup(K,{emit:o}){const t=K,m=o,b=ae({get:()=>t.modelValue,set:a=>m("update:modelValue",a)}),p=R(""),d=R("group"),h=R(new Set),M=R([]),V=(a,l)=>{const y=document.querySelector(`input[data-group="${a}"]`);y&&(y.indeterminate=q(l))};ke(()=>t.selectedToolIds,a=>{M.value=[...a]},{immediate:!0});const w=ae(()=>{let a=t.tools.filter(l=>l.key);if(p.value){const l=p.value.toLowerCase();a=a.filter(y=>{var O;return y.name.toLowerCase().includes(l)||y.description.toLowerCase().includes(l)||(((O=y.serviceGroup)==null?void 0:O.toLowerCase().includes(l))??!1)})}switch(d.value){case"name":a=[...a].sort((l,y)=>l.name.localeCompare(y.name));break;case"enabled":a=[...a].sort((l,y)=>{const O=M.value.includes(l.key),I=M.value.includes(y.key);return O&&!I?-1:!O&&I?1:l.name.localeCompare(y.name)});break;case"group":default:a=[...a].sort((l,y)=>{const O=l.serviceGroup??"未分组",I=y.serviceGroup??"未分组";return O!==I?O.localeCompare(I):l.name.localeCompare(y.name)});break}return a}),U=ae(()=>{const a=new Map;return w.value.forEach(l=>{const y=l.serviceGroup??"未分组";a.has(y)||a.set(y,[]),a.get(y).push(l)}),new Map([...a.entries()].sort())}),z=ae(()=>w.value.length);ke([M,U],()=>{Fe(()=>{for(const[a,l]of U.value)V(a,l)})},{flush:"post",deep:!1});const Q=a=>M.value.includes(a),te=(a,l)=>{l.stopPropagation();const O=l.target.checked;if(!a){console.error("toolKey is undefined, cannot proceed");return}O?M.value.includes(a)||(M.value=[...M.value,a]):M.value=M.value.filter(I=>I!==a)},L=a=>a.filter(l=>M.value.includes(l.key)),v=a=>a.length>0&&a.every(l=>M.value.includes(l.key)),q=a=>{const l=L(a).length;return l>0&&l<a.length},F=(a,l)=>{l.stopPropagation();const O=l.target.checked,I=a.map(X=>X.key);if(O){const X=[...M.value];I.forEach(se=>{X.includes(se)||X.push(se)}),M.value=X}else M.value=M.value.filter(X=>!I.includes(X))},g=a=>{h.value.has(a)?h.value.delete(a):h.value.add(a)},P=()=>{m("confirm",[...M.value]),m("update:modelValue",!1)},x=()=>{M.value=[...t.selectedToolIds],m("update:modelValue",!1)};return ke(b,a=>{if(a){h.value.clear();const l=Array.from(U.value.keys());l.length>1&&l.slice(1).forEach(y=>{h.value.add(y)})}}),(a,l)=>(i(),ie(pe,{modelValue:b.value,"onUpdate:modelValue":[l[4]||(l[4]=y=>b.value=y),x],title:"选择工具",onConfirm:P},{default:Z(()=>[e("div",_t,[e("div",bt,[e("div",$t,[j(e("input",{"onUpdate:modelValue":l[0]||(l[0]=y=>p.value=y),type:"text",class:"search-input",placeholder:"搜索工具..."},null,512),[[J,p.value]])]),e("div",Ct,[j(e("select",{"onUpdate:modelValue":l[1]||(l[1]=y=>d.value=y),class:"sort-select"},l[5]||(l[5]=[e("option",{value:"group"},"按服务组排序",-1),e("option",{value:"name"},"按名称排序",-1),e("option",{value:"enabled"},"按启用状态排序",-1)]),512),[[Be,d.value]])])]),e("div",wt,[e("span",kt," 共 "+s(U.value.size)+" 个服务组，"+s(z.value)+" 个工具 (已选择 "+s(M.value.length)+" 个) ",1)]),U.value.size>0?(i(),c("div",St,[(i(!0),c(Y,null,W(U.value,([y,O])=>(i(),c("div",{key:y,class:"tool-group"},[e("div",{class:oe(["tool-group-header",{collapsed:h.value.has(y)}]),onClick:I=>g(y)},[e("div",At,[C(n(E),{icon:h.value.has(y)?"carbon:chevron-right":"carbon:chevron-down",class:"collapse-icon"},null,8,["icon"]),C(n(E),{icon:"carbon:folder",class:"group-icon"}),e("span",xt,s(y),1),e("span",Et," ("+s(L(O).length)+"/"+s(O.length)+") ",1)]),e("div",{class:"group-actions",onClick:l[2]||(l[2]=ye(()=>{},["stop"]))},[e("label",Mt,[e("input",{type:"checkbox",class:"group-enable-checkbox",checked:v(O),onChange:I=>F(O,I),"data-group":y},null,40,Ut),l[6]||(l[6]=e("span",{class:"enable-label"},"启用全部",-1))])])],10,Tt),e("div",{class:oe(["tool-group-content",{collapsed:h.value.has(y)}])},[(i(!0),c(Y,null,W(O.filter(I=>I&&I.key),I=>(i(),c("div",{key:I.key,class:"tool-selection-item"},[e("div",Vt,[e("div",Nt,s(I.name),1),I.description?(i(),c("div",Pt,s(I.description),1)):N("",!0)]),e("div",Bt,[e("label",{class:"tool-enable-switch",onClick:l[3]||(l[3]=ye(()=>{},["stop"]))},[e("input",{type:"checkbox",class:"tool-enable-checkbox",checked:Q(I.key),onChange:X=>te(I.key,X)},null,40,Ft),l[7]||(l[7]=e("span",{class:"tool-enable-slider"},null,-1))])])]))),128))],2)]))),128))])):(i(),c("div",Rt,[C(n(E),{icon:"carbon:tools",class:"empty-icon"}),l[8]||(l[8]=e("p",null,"没有找到工具",-1))]))])]),_:1},8,["modelValue"]))}}),Lt=ce(Dt,[["__scopeId","data-v-c30d6872"]]);class ue{static async handleResponse(o){if(!o.ok)try{const t=await o.json();throw new Error(t.message||`API request failed: ${o.status}`)}catch{throw new Error(`API request failed: ${o.status} ${o.statusText}`)}return o}static async getAllAgents(){try{const o=await fetch(this.BASE_URL);return await(await this.handleResponse(o)).json()}catch(o){throw console.error("Failed to get Agent list:",o),o}}static async getAgentById(o){try{const t=await fetch(`${this.BASE_URL}/${o}`);return await(await this.handleResponse(t)).json()}catch(t){throw console.error(`Failed to get Agent[${o}] details:`,t),t}}static async createAgent(o){try{const t=await fetch(this.BASE_URL,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});return await(await this.handleResponse(t)).json()}catch(t){throw console.error("Failed to create Agent:",t),t}}static async updateAgent(o,t){try{const m=await fetch(`${this.BASE_URL}/${o}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});return await(await this.handleResponse(m)).json()}catch(m){throw console.error(`Failed to update Agent[${o}]:`,m),m}}static async deleteAgent(o){try{const t=await fetch(`${this.BASE_URL}/${o}`,{method:"DELETE"});if(t.status===400)throw new Error("Cannot delete default Agent");await this.handleResponse(t)}catch(t){throw console.error(`Failed to delete Agent[${o}]:`,t),t}}static async getAvailableTools(){try{const o=await fetch(`${this.BASE_URL}/tools`);return await(await this.handleResponse(o)).json()}catch(o){throw console.error("Failed to get available tools list:",o),o}}}fe(ue,"BASE_URL","/api/agents");class de{static async handleResponse(o){if(!o.ok)try{const t=await o.json();throw new Error(t.message||`API request failed: ${o.status}`)}catch{throw new Error(`API request failed: ${o.status} ${o.statusText}`)}return o}static async getAllModels(){try{const o=await fetch(this.BASE_URL);return await(await this.handleResponse(o)).json()}catch(o){throw console.error("Failed to get Model list:",o),o}}static async getAllTypes(){try{const o=await fetch(`${this.BASE_URL}/types`);return await(await this.handleResponse(o)).json()}catch(o){throw console.error("Failed to get Model list:",o),o}}static async getModelById(o){try{const t=await fetch(`${this.BASE_URL}/${o}`);return await(await this.handleResponse(t)).json()}catch(t){throw console.error(`Failed to get Model[${o}] details:`,t),t}}static async createModel(o){try{const t=await fetch(this.BASE_URL,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});return await(await this.handleResponse(t)).json()}catch(t){throw console.error("Failed to create Model:",t),t}}static async updateModel(o,t){try{const m=await fetch(`${this.BASE_URL}/${o}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});return await(await this.handleResponse(m)).json()}catch(m){throw console.error(`Failed to update Model[${o}]:`,m),m}}static async deleteModel(o){try{const t=await fetch(`${this.BASE_URL}/${o}`,{method:"DELETE"});if(t.status===400)throw new Error("Cannot delete default Model");await this.handleResponse(t)}catch(t){throw console.error(`Failed to delete Model[${o}]:`,t),t}}}fe(de,"BASE_URL","/api/models");const It={class:"config-panel"},Ot={class:"panel-header"},qt={class:"panel-actions"},jt=["disabled"],Gt={class:"agent-layout"},Kt={class:"agent-list"},Jt={class:"list-header"},zt={class:"agent-count"},Ht={key:0,class:"agents-container"},Xt=["onClick"],Yt={class:"agent-card-header"},Wt={class:"agent-name"},Qt={class:"agent-desc"},Zt={key:0,class:"agent-model"},es={class:"model-tag"},os={class:"model-tag"},ts={key:1,class:"agent-tools"},ss={key:0,class:"tool-more"},ns={key:1,class:"loading-state"},as={key:2,class:"empty-state"},ls={key:0,class:"agent-detail"},is={class:"detail-header"},cs={class:"detail-actions"},rs={class:"form-item"},ds=["placeholder"],us={class:"form-item"},ps=["placeholder"],gs={class:"form-item"},fs=["value","placeholder"],ms={class:"model-section"},vs={class:"form-item"},hs={class:"model-chooser"},ys=["title"],_s={key:0,class:"current-model"},bs={class:"model-type"},$s={class:"model-name"},Cs={key:1,class:"current-model"},ws={class:"current-model"},ks={class:"dropdown-header"},Ss={class:"model-options"},Ts=["onClick"],As={class:"model-type"},xs={class:"model-name"},Es={class:"tools-section"},Ms={class:"assigned-tools"},Us={class:"section-header"},Vs={class:"tools-grid"},Ns={class:"tool-info"},Ps={class:"tool-name"},Bs={class:"tool-desc"},Fs={key:0,class:"no-tools"},Rs={key:1,class:"no-selection"},Ds={class:"modal-form"},Ls={class:"form-item"},Is=["placeholder"],Os={class:"form-item"},qs=["placeholder"],js={class:"form-item"},Gs=["value","placeholder"],Ks={class:"delete-confirm"},Js={class:"warning-text"},zs=re({__name:"agentConfig",setup(K){const{t:o}=ve(),t=R(!1),m=R(""),b=R(""),p=ne([]),d=R(null),h=ne([]),M=R(!1),V=R(!1),w=R(!1),U=R(!1),z=R(null),Q=ne([]),te=()=>{U.value=!U.value},L=A=>{z.value=A,U.value=!1},v=ne({name:"",description:"",nextStepPrompt:""}),q=A=>{const f=h.find(G=>G.key===A);return f?f.name:A},F=A=>{const f=h.find(G=>G.key===A);return f?f.description:""},g=(A,f)=>{f==="success"?(b.value=A,setTimeout(()=>{b.value=""},3e3)):(m.value=A,setTimeout(()=>{m.value=""},5e3))},P=async()=>{t.value=!0;try{const[A,f,G]=await Promise.all([ue.getAllAgents(),ue.getAvailableTools(),de.getAllModels()]),$=A.map(r=>({...r,availableTools:r.availableTools,...G}));p.splice(0,p.length,...$),h.splice(0,h.length,...f),Q.splice(0,Q.length,...G),$.length>0&&await x($[0])}catch(A){console.error("加载数据失败:",A),g(o("config.agentConfig.loadDataFailed")+": "+A.message,"error");const f=[{key:"search-web",name:"网络搜索",description:"在互联网上搜索信息",enabled:!0,serviceGroup:"搜索服务"},{key:"search-local",name:"本地搜索",description:"在本地文件中搜索内容",enabled:!0,serviceGroup:"搜索服务"},{key:"file-read",name:"读取文件",description:"读取本地或远程文件内容",enabled:!0,serviceGroup:"文件服务"},{key:"file-write",name:"写入文件",description:"创建或修改文件内容",enabled:!0,serviceGroup:"文件服务"},{key:"file-delete",name:"删除文件",description:"删除指定的文件",enabled:!1,serviceGroup:"文件服务"},{key:"calculator",name:"计算器",description:"执行数学计算",enabled:!0,serviceGroup:"计算服务"},{key:"code-execute",name:"代码执行",description:"执行Python或JavaScript代码",enabled:!0,serviceGroup:"计算服务"},{key:"weather",name:"天气查询",description:"获取指定地区的天气信息",enabled:!0,serviceGroup:"信息服务"},{key:"currency",name:"汇率查询",description:"查询货币汇率信息",enabled:!0,serviceGroup:"信息服务"},{key:"email",name:"发送邮件",description:"发送电子邮件",enabled:!1,serviceGroup:"通信服务"},{key:"sms",name:"发送短信",description:"发送短信消息",enabled:!1,serviceGroup:"通信服务"}],G=[{id:"demo-1",name:"通用助手",description:"一个能够处理各种任务的智能助手",nextStepPrompt:"You are a helpful assistant that can answer questions and help with various tasks. What would you like me to help you with next?",availableTools:["search-web","calculator","weather"]},{id:"demo-2",name:"数据分析师",description:"专门用于数据分析和可视化的Agent",nextStepPrompt:"You are a data analyst assistant specialized in analyzing data and creating visualizations. Please provide the data you would like me to analyze.",availableTools:["file-read","file-write","calculator","code-execute"]}];h.splice(0,h.length,...f),p.splice(0,p.length,...G),G.length>0&&(d.value=G[0])}finally{t.value=!1}},x=async A=>{try{const f=await ue.getAgentById(A.id);d.value={...f,availableTools:f.availableTools},z.value=f.model??null}catch(f){console.error("加载Agent详情失败:",f),g(o("config.agentConfig.loadDetailsFailed")+": "+f.message,"error"),d.value={...A,availableTools:A.availableTools}}},a=()=>{v.name="",v.description="",v.nextStepPrompt="",M.value=!0},l=async()=>{var A;if(!v.name.trim()||!v.description.trim()){g(o("config.agentConfig.requiredFields"),"error");return}try{const f={name:v.name.trim(),description:v.description.trim(),nextStepPrompt:((A=v.nextStepPrompt)==null?void 0:A.trim())??"",availableTools:[]},G=await ue.createAgent(f);p.push(G),d.value=G,M.value=!1,g(o("config.agentConfig.createSuccess"),"success")}catch(f){g(o("config.agentConfig.createFailed")+": "+f.message,"error")}},y=()=>{w.value=!0},O=A=>{d.value&&(d.value.availableTools=[...A])},I=async()=>{if(d.value){if(!d.value.name.trim()||!d.value.description.trim()){g(o("config.agentConfig.requiredFields"),"error");return}try{d.value.model=z.value;const A=await ue.updateAgent(d.value.id,d.value),f=p.findIndex(G=>G.id===A.id);f!==-1&&(p[f]=A),d.value=A,d.value.model=z.value,g(o("config.agentConfig.saveSuccess"),"success")}catch(A){g(o("config.agentConfig.saveFailed")+": "+A.message,"error")}}},X=()=>{V.value=!0},se=async()=>{if(d.value)try{await ue.deleteAgent(d.value.id);const A=p.findIndex(f=>f.id===d.value.id);A!==-1&&p.splice(A,1),d.value=p.length>0?p[0]:null,V.value=!1,g(o("config.agentConfig.deleteSuccess"),"success")}catch(A){g(o("config.agentConfig.deleteFailed")+": "+A.message,"error")}},be=()=>{const A=document.createElement("input");A.type="file",A.accept=".json",A.onchange=f=>{var $;const G=($=f.target.files)==null?void 0:$[0];if(G){const r=new FileReader;r.onload=async _=>{var k;try{const S=JSON.parse((k=_.target)==null?void 0:k.result);if(!S.name||!S.description)throw new Error(o("config.agentConfig.invalidFormat"));const{id:u,...B}=S,D=await ue.createAgent(B);p.push(D),d.value=D,g(o("config.agentConfig.importSuccess"),"success")}catch(S){g(o("config.agentConfig.importFailed")+": "+S.message,"error")}},r.readAsText(G)}},A.click()},ge=()=>{if(d.value)try{const A=JSON.stringify(d.value,null,2),f=new Blob([A],{type:"application/json"}),G=URL.createObjectURL(f),$=document.createElement("a");$.href=G,$.download=`agent-${d.value.name}-${new Date().toISOString().split("T")[0]}.json`,$.click(),URL.revokeObjectURL(G),g(o("config.agentConfig.exportSuccess"),"success")}catch(A){g(o("config.agentConfig.exportFailed")+": "+A.message,"error")}};return _e(()=>{P()}),(A,f)=>{var G;return i(),c("div",It,[e("div",Ot,[e("h2",null,s(n(o)("config.agentConfig.title")),1),e("div",qt,[e("button",{class:"action-btn",onClick:be},[C(n(E),{icon:"carbon:upload"}),T(" "+s(n(o)("config.agentConfig.import")),1)]),e("button",{class:"action-btn",onClick:ge,disabled:!d.value},[C(n(E),{icon:"carbon:download"}),T(" "+s(n(o)("config.agentConfig.export")),1)],8,jt)])]),e("div",Gt,[e("div",Kt,[e("div",Jt,[e("h3",null,s(n(o)("config.agentConfig.configuredAgents")),1),e("span",zt,"("+s(p.length)+s(n(o)("config.agentConfig.agentCount"))+")",1)]),t.value?N("",!0):(i(),c("div",Ht,[(i(!0),c(Y,null,W(p,$=>{var r,_;return i(),c("div",{key:$.id,class:oe(["agent-card",{active:((r=d.value)==null?void 0:r.id)===$.id}]),onClick:k=>x($)},[e("div",Yt,[e("span",Wt,s($.name),1),C(n(E),{icon:"carbon:chevron-right"})]),e("p",Qt,s($.description),1),$.model?(i(),c("div",Zt,[e("span",es,s($.model.type),1),e("span",os,s($.model.modelName),1)])):N("",!0),((_=$.availableTools)==null?void 0:_.length)>0?(i(),c("div",ts,[(i(!0),c(Y,null,W($.availableTools.slice(0,3),k=>(i(),c("span",{key:k,class:"tool-tag"},s(q(k)),1))),128)),$.availableTools.length>3?(i(),c("span",ss," +"+s($.availableTools.length-3),1)):N("",!0)])):N("",!0)],10,Xt)}),128))])),t.value?(i(),c("div",ns,[C(n(E),{icon:"carbon:loading",class:"loading-icon"}),T(" "+s(n(o)("common.loading")),1)])):N("",!0),!t.value&&p.length===0?(i(),c("div",as,[C(n(E),{icon:"carbon:bot",class:"empty-icon"}),e("p",null,s(n(o)("config.agentConfig.noAgent")),1)])):N("",!0),e("button",{class:"add-btn",onClick:a},[C(n(E),{icon:"carbon:add"}),T(" "+s(n(o)("config.agentConfig.createNew")),1)])]),d.value?(i(),c("div",ls,[e("div",is,[e("h3",null,s(d.value.name),1),e("div",cs,[e("button",{class:"action-btn primary",onClick:I},[C(n(E),{icon:"carbon:save"}),T(" "+s(n(o)("common.save")),1)]),e("button",{class:"action-btn danger",onClick:X},[C(n(E),{icon:"carbon:trash-can"}),T(" "+s(n(o)("common.delete")),1)])])]),e("div",rs,[e("label",null,[T(s(n(o)("config.agentConfig.agentName"))+" ",1),f[15]||(f[15]=e("span",{class:"required"},"*",-1))]),j(e("input",{type:"text","onUpdate:modelValue":f[0]||(f[0]=$=>d.value.name=$),placeholder:n(o)("config.agentConfig.agentNamePlaceholder"),required:""},null,8,ds),[[J,d.value.name]])]),e("div",us,[e("label",null,[T(s(n(o)("config.agentConfig.description"))+" ",1),f[16]||(f[16]=e("span",{class:"required"},"*",-1))]),j(e("textarea",{"onUpdate:modelValue":f[1]||(f[1]=$=>d.value.description=$),rows:"3",placeholder:n(o)("config.agentConfig.descriptionPlaceholder"),required:""},null,8,ps),[[J,d.value.description]])]),e("div",gs,[e("label",null,s(n(o)("config.agentConfig.nextStepPrompt")),1),e("textarea",{value:d.value.nextStepPrompt||"",onInput:f[2]||(f[2]=$=>d.value.nextStepPrompt=$.target.value),rows:"8",placeholder:n(o)("config.agentConfig.nextStepPromptPlaceholder")},null,40,fs)]),e("div",ms,[e("h4",null,s(n(o)("config.agentConfig.modelConfiguration")),1),e("div",vs,[e("div",hs,[e("button",{class:"model-btn",onClick:te,title:A.$t("model.switch")},[C(n(E),{icon:"carbon:build-run",width:"18"}),z.value?(i(),c("span",_s,[e("span",bs,s(z.value.type),1),f[17]||(f[17]=e("span",{class:"spacer"},null,-1)),e("span",$s,s(z.value.modelName),1)])):(i(),c("span",Cs,[e("span",ws,s(n(o)("config.agentConfig.modelConfigurationLabel")),1)])),C(n(E),{icon:U.value?"carbon:chevron-up":"carbon:chevron-down",width:"14",class:"chevron"},null,8,["icon"])],8,ys),U.value?(i(),c("div",{key:0,class:"model-dropdown",onClick:f[4]||(f[4]=ye(()=>{},["stop"]))},[e("div",ks,[e("span",null,s(n(o)("config.agentConfig.modelConfigurationLabel")),1),e("button",{class:"close-btn",onClick:f[3]||(f[3]=$=>U.value=!1)},[C(n(E),{icon:"carbon:close",width:"16"})])]),e("div",Ss,[(i(!0),c(Y,null,W(Q,$=>{var r,_;return i(),c("button",{key:$.id,class:oe(["model-option",{active:((r=z.value)==null?void 0:r.id)===$.id}]),onClick:k=>L($)},[e("span",As,s($.type),1),e("span",xs,s($.modelName),1),((_=z.value)==null?void 0:_.id)===$.id?(i(),ie(n(E),{key:0,icon:"carbon:checkmark",width:"16",class:"check-icon"})):N("",!0)],10,Ts)}),128))])])):N("",!0),U.value?(i(),c("div",{key:1,class:"backdrop",onClick:f[5]||(f[5]=$=>U.value=!1)})):N("",!0)])])]),e("div",Es,[e("h4",null,s(n(o)("config.agentConfig.toolConfiguration")),1),e("div",Ms,[e("div",Us,[e("span",null,s(n(o)("config.agentConfig.assignedTools"))+" ("+s((d.value.availableTools||[]).length)+")",1),h.length>0?(i(),c("button",{key:0,class:"action-btn small",onClick:y},[C(n(E),{icon:"carbon:add"}),T(" "+s(n(o)("config.agentConfig.addRemoveTools")),1)])):N("",!0)]),e("div",Vs,[(i(!0),c(Y,null,W(d.value.availableTools||[],$=>(i(),c("div",{key:$,class:"tool-item assigned"},[e("div",Ns,[e("span",Ps,s(q($)),1),e("span",Bs,s(F($)),1)])]))),128)),d.value.availableTools.length===0?(i(),c("div",Fs,[C(n(E),{icon:"carbon:tool-box"}),e("span",null,s(n(o)("config.agentConfig.noAssignedTools")),1)])):N("",!0)])])])])):(i(),c("div",Rs,[C(n(E),{icon:"carbon:bot",class:"placeholder-icon"}),e("p",null,s(n(o)("config.agentConfig.selectAgentHint")),1)]))]),C(pe,{modelValue:M.value,"onUpdate:modelValue":f[9]||(f[9]=$=>M.value=$),title:n(o)("config.agentConfig.newAgent"),onConfirm:l},{default:Z(()=>[e("div",Ds,[e("div",Ls,[e("label",null,[T(s(n(o)("config.agentConfig.agentName"))+" ",1),f[18]||(f[18]=e("span",{class:"required"},"*",-1))]),j(e("input",{type:"text","onUpdate:modelValue":f[6]||(f[6]=$=>v.name=$),placeholder:n(o)("config.agentConfig.agentNamePlaceholder"),required:""},null,8,Is),[[J,v.name]])]),e("div",Os,[e("label",null,[T(s(n(o)("config.agentConfig.description"))+" ",1),f[19]||(f[19]=e("span",{class:"required"},"*",-1))]),j(e("textarea",{"onUpdate:modelValue":f[7]||(f[7]=$=>v.description=$),rows:"3",placeholder:n(o)("config.agentConfig.descriptionPlaceholder"),required:""},null,8,qs),[[J,v.description]])]),e("div",js,[e("label",null,s(n(o)("config.agentConfig.nextStepPrompt")),1),e("textarea",{value:v.nextStepPrompt||"",onInput:f[8]||(f[8]=$=>v.nextStepPrompt=$.target.value),rows:"8",placeholder:n(o)("config.agentConfig.nextStepPromptPlaceholder")},null,40,Gs)])])]),_:1},8,["modelValue","title"]),C(Lt,{modelValue:w.value,"onUpdate:modelValue":f[10]||(f[10]=$=>w.value=$),tools:h,"selected-tool-ids":((G=d.value)==null?void 0:G.availableTools)||[],onConfirm:O},null,8,["modelValue","tools","selected-tool-ids"]),C(pe,{modelValue:V.value,"onUpdate:modelValue":f[12]||(f[12]=$=>V.value=$),title:n(o)("config.agentConfig.deleteConfirm")},{footer:Z(()=>[e("button",{class:"cancel-btn",onClick:f[11]||(f[11]=$=>V.value=!1)},s(n(o)("common.cancel")),1),e("button",{class:"confirm-btn danger",onClick:se},s(n(o)("common.delete")),1)]),default:Z(()=>{var $;return[e("div",Ks,[C(n(E),{icon:"carbon:warning",class:"warning-icon"}),e("p",null,[T(s(n(o)("config.agentConfig.deleteConfirmText"))+" ",1),e("strong",null,s(($=d.value)==null?void 0:$.name),1),T(" "+s(n(o)("common.confirm"))+"？",1)]),e("p",Js,s(n(o)("config.agentConfig.deleteWarning")),1)])]}),_:1},8,["modelValue","title"]),m.value?(i(),c("div",{key:0,class:"error-toast",onClick:f[13]||(f[13]=$=>m.value="")},[C(n(E),{icon:"carbon:error"}),T(" "+s(m.value),1)])):N("",!0),b.value?(i(),c("div",{key:1,class:"success-toast",onClick:f[14]||(f[14]=$=>b.value="")},[C(n(E),{icon:"carbon:checkmark"}),T(" "+s(b.value),1)])):N("",!0)])}}}),Hs=ce(zs,[["__scopeId","data-v-86b6e145"]]),Xs={class:"custom-select"},Ys=["title"],Ws={key:0,class:"current-option"},Qs={class:"option-name"},Zs={key:1,class:"current-option"},en={class:"dropdown-header"},on={class:"select-options"},tn=["onClick"],sn={class:"option-name"},nn=re({__name:"index",props:{modelValue:{},options:{},placeholder:{},dropdownTitle:{},icon:{}},emits:["update:modelValue"],setup(K,{emit:o}){const t=K,m=o,b=R(!1),p=ae(()=>t.options.find(V=>V.id===t.modelValue)),d=V=>V.id===t.modelValue,h=()=>{b.value=!b.value},M=V=>{m("update:modelValue",V.id),b.value=!1};return(V,w)=>(i(),c("div",Xs,[e("button",{class:"select-btn",onClick:h,title:V.placeholder},[C(n(E),{icon:t.icon||"carbon:select-01",width:"18"},null,8,["icon"]),p.value?(i(),c("span",Ws,[e("span",Qs,s(p.value.name),1)])):(i(),c("span",Zs,s(V.placeholder),1)),C(n(E),{icon:b.value?"carbon:chevron-up":"carbon:chevron-down",width:"14",class:"chevron"},null,8,["icon"])],8,Ys),C(Ce,{name:"slideDown"},{default:Z(()=>[j(e("div",{class:"select-dropdown",onClick:w[1]||(w[1]=ye(()=>{},["stop"]))},[e("div",en,[e("span",null,s(V.dropdownTitle),1),e("button",{class:"close-btn",onClick:w[0]||(w[0]=U=>b.value=!1)},[C(n(E),{icon:"carbon:close",width:"16"})])]),e("div",on,[(i(!0),c(Y,null,W(V.options,U=>(i(),c("button",{key:U.id,class:oe(["select-option",{active:d(U)}]),onClick:z=>M(U)},[e("span",sn,s(U.name),1),d(U)?(i(),ie(n(E),{key:0,icon:"carbon:checkmark",width:"16",class:"check-icon"})):N("",!0)],10,tn))),128))])],512),[[Ee,b.value]])]),_:1}),b.value?(i(),c("div",{key:0,class:"backdrop",onClick:w[2]||(w[2]=U=>b.value=!1)})):N("",!0)]))}}),xe=ce(nn,[["__scopeId","data-v-ed05fea8"]]),an={class:"config-panel"},ln={class:"panel-header"},cn={class:"panel-actions"},rn=["disabled"],dn={class:"model-layout"},un={class:"model-list"},pn={class:"list-header"},gn={class:"model-count"},fn={key:0,class:"models-container"},mn=["onClick"],vn={class:"model-card-header"},hn={class:"model-name"},yn={class:"model-desc"},_n={key:0,class:"model-type"},bn={class:"model-tag"},$n={key:1,class:"loading-state"},Cn={key:2,class:"empty-state"},wn={key:0,class:"model-detail"},kn={class:"detail-header"},Sn={class:"detail-actions"},Tn={class:"form-item"},An={class:"form-item"},xn=["placeholder"],En={class:"form-item"},Mn=["placeholder"],Un={class:"form-item"},Vn=["placeholder"],Nn={class:"form-item"},Pn=["placeholder"],Bn={key:1,class:"no-selection"},Fn={class:"modal-form"},Rn={class:"form-item"},Dn={class:"form-item"},Ln=["placeholder"],In={class:"form-item"},On=["placeholder"],qn={class:"form-item"},jn=["placeholder"],Gn={class:"form-item"},Kn=["placeholder"],Jn={class:"delete-confirm"},zn={class:"warning-text"},Hn=re({__name:"modelConfig",setup(K){const{t:o}=ve(),t=R(!1),m=R(""),b=R(""),p=ne([]),d=ne([]),h=R(null),M=R(!1),V=R(!1),w=ne({baseUrl:"",apiKey:"",modelName:"",modelDescription:"",type:""}),U=(x,a)=>{a==="success"?(b.value=x,setTimeout(()=>{b.value=""},3e3)):(m.value=x,setTimeout(()=>{m.value=""},5e3))},z=async()=>{t.value=!0;try{const[x,a]=await Promise.all([de.getAllModels(),de.getAllTypes()]),l=x.map(y=>({...y}));p.splice(0,p.length,...l),d.splice(0,p.length,...a),l.length>0&&await Q(l[0])}catch(x){console.error("加载数据失败:",x),U(o("config.modelConfig.loadDataFailed")+": "+x.message,"error")}finally{t.value=!1}},Q=async x=>{try{const a=await de.getModelById(x.id);h.value={...a}}catch(a){console.error("加载Model详情失败:",a),U(o("config.modelConfig.loadDetailsFailed")+": "+a.message,"error"),h.value={...x}}},te=()=>{w.baseUrl="",w.apiKey="",w.modelName="",w.modelDescription="",w.type="",M.value=!0},L=async()=>{if(!w.modelName.trim()||!w.modelDescription.trim()){U(o("config.modelConfig.requiredFields"),"error");return}try{const x={baseUrl:w.baseUrl.trim(),apiKey:w.apiKey.trim(),modelName:w.modelName.trim(),modelDescription:w.modelDescription.trim(),type:w.type.trim()},a=await de.createModel(x);p.push(a),h.value=a,M.value=!1,U(o("config.modelConfig.createSuccess"),"success")}catch(x){U(o("config.modelConfig.createFailed")+": "+x.message,"error")}},v=async()=>{if(h.value){if(!h.value.modelName.trim()||!h.value.modelDescription.trim()){U(o("config.modelConfig.requiredFields"),"error");return}try{const x=await de.updateModel(h.value.id,h.value),a=p.findIndex(l=>l.id===x.id);a!==-1&&(p[a]=x),h.value=x,U(o("config.modelConfig.saveSuccess"),"success")}catch(x){U(o("config.modelConfig.saveFailed")+": "+x.message,"error")}}},q=()=>{V.value=!0},F=async()=>{if(h.value)try{await de.deleteModel(h.value.id);const x=p.findIndex(a=>a.id===h.value.id);x!==-1&&p.splice(x,1),h.value=p.length>0?p[0]:null,V.value=!1,U(o("config.modelConfig.deleteSuccess"),"success")}catch(x){U(o("config.modelConfig.deleteFailed")+": "+x.message,"error")}},g=()=>{const x=document.createElement("input");x.type="file",x.accept=".json",x.onchange=a=>{var y;const l=(y=a.target.files)==null?void 0:y[0];if(l){const O=new FileReader;O.onload=async I=>{var X;try{const se=JSON.parse((X=I.target)==null?void 0:X.result);if(!se.modelName||!se.modelDescription)throw new Error(o("config.modelConfig.invalidFormat"));const{id:be,...ge}=se,A=await de.createModel(ge);p.push(A),h.value=A,U(o("config.modelConfig.importSuccess"),"success")}catch(se){U(o("config.modelConfig.importFailed")+": "+se.message,"error")}},O.readAsText(l)}},x.click()},P=()=>{if(h.value)try{const x=JSON.stringify(h.value,null,2),a=new Blob([x],{type:"application/json"}),l=URL.createObjectURL(a),y=document.createElement("a");y.href=l,y.download=`model-${h.value.modelName}-${new Date().toISOString().split("T")[0]}.json`,y.click(),URL.revokeObjectURL(l),U(o("config.modelConfig.exportSuccess"),"success")}catch(x){U(o("config.modelConfig.exportFailed")+": "+x.message,"error")}};return _e(()=>{z()}),(x,a)=>(i(),c("div",an,[e("div",ln,[e("h2",null,s(n(o)("config.modelConfig.title")),1),e("div",cn,[e("button",{class:"action-btn",onClick:g},[C(n(E),{icon:"carbon:upload"}),T(" "+s(n(o)("config.modelConfig.import")),1)]),e("button",{class:"action-btn",onClick:P,disabled:!h.value},[C(n(E),{icon:"carbon:download"}),T(" "+s(n(o)("config.modelConfig.export")),1)],8,rn)])]),e("div",dn,[e("div",un,[e("div",pn,[e("h3",null,s(n(o)("config.modelConfig.configuredModels")),1),e("span",gn,"("+s(p.length)+")",1)]),t.value?N("",!0):(i(),c("div",fn,[(i(!0),c(Y,null,W(p,l=>{var y;return i(),c("div",{key:l.id,class:oe(["model-card",{active:((y=h.value)==null?void 0:y.id)===l.id}]),onClick:O=>Q(l)},[e("div",vn,[e("span",hn,s(l.modelName),1),C(n(E),{icon:"carbon:chevron-right"})]),e("p",yn,s(l.modelDescription),1),l.type?(i(),c("div",_n,[e("span",bn,s(l.type),1)])):N("",!0)],10,mn)}),128))])),t.value?(i(),c("div",$n,[C(n(E),{icon:"carbon:loading",class:"loading-icon"}),T(" "+s(n(o)("common.loading")),1)])):N("",!0),!t.value&&p.length===0?(i(),c("div",Cn,[C(n(E),{icon:"carbon:bot",class:"empty-icon"}),e("p",null,s(n(o)("config.modelConfig.noModel")),1)])):N("",!0),e("button",{class:"add-btn",onClick:te},[C(n(E),{icon:"carbon:add"}),T(" "+s(n(o)("config.modelConfig.createNew")),1)])]),h.value?(i(),c("div",wn,[e("div",kn,[e("h3",null,s(h.value.modelName),1),e("div",Sn,[e("button",{class:"action-btn primary",onClick:v},[C(n(E),{icon:"carbon:save"}),T(" "+s(n(o)("common.save")),1)]),e("button",{class:"action-btn danger",onClick:q},[C(n(E),{icon:"carbon:trash-can"}),T(" "+s(n(o)("common.delete")),1)])])]),e("div",Tn,[e("label",null,[T(s(n(o)("config.modelConfig.type"))+" ",1),a[15]||(a[15]=e("span",{class:"required"},"*",-1))]),C(xe,{modelValue:h.value.type,"onUpdate:modelValue":a[0]||(a[0]=l=>h.value.type=l),options:d.map(l=>({id:l,name:l})),placeholder:n(o)("config.modelConfig.typePlaceholder"),"dropdown-title":n(o)("config.modelConfig.typePlaceholder"),icon:"carbon:types"},null,8,["modelValue","options","placeholder","dropdown-title"])]),e("div",An,[e("label",null,[T(s(n(o)("config.modelConfig.baseUrl"))+" ",1),a[16]||(a[16]=e("span",{class:"required"},"*",-1))]),j(e("input",{type:"text","onUpdate:modelValue":a[1]||(a[1]=l=>h.value.baseUrl=l),placeholder:n(o)("config.modelConfig.baseUrlPlaceholder"),required:""},null,8,xn),[[J,h.value.baseUrl]])]),e("div",En,[e("label",null,[T(s(n(o)("config.modelConfig.apiKey"))+" ",1),a[17]||(a[17]=e("span",{class:"required"},"*",-1))]),j(e("input",{type:"text","onUpdate:modelValue":a[2]||(a[2]=l=>h.value.apiKey=l),placeholder:n(o)("config.modelConfig.apiKeyPlaceholder"),required:""},null,8,Mn),[[J,h.value.apiKey]])]),e("div",Un,[e("label",null,[T(s(n(o)("config.modelConfig.modelName"))+" ",1),a[18]||(a[18]=e("span",{class:"required"},"*",-1))]),j(e("input",{type:"text","onUpdate:modelValue":a[3]||(a[3]=l=>h.value.modelName=l),placeholder:n(o)("config.modelConfig.modelNamePlaceholder"),required:""},null,8,Vn),[[J,h.value.modelName]])]),e("div",Nn,[e("label",null,[T(s(n(o)("config.modelConfig.description"))+" ",1),a[19]||(a[19]=e("span",{class:"required"},"*",-1))]),j(e("textarea",{"onUpdate:modelValue":a[4]||(a[4]=l=>h.value.modelDescription=l),rows:"3",placeholder:n(o)("config.modelConfig.descriptionPlaceholder"),required:""},null,8,Pn),[[J,h.value.modelDescription]])])])):(i(),c("div",Bn,[C(n(E),{icon:"carbon:bot",class:"placeholder-icon"}),e("p",null,s(n(o)("config.modelConfig.selectModelHint")),1)]))]),C(pe,{modelValue:M.value,"onUpdate:modelValue":a[10]||(a[10]=l=>M.value=l),title:n(o)("config.modelConfig.newModel"),onConfirm:L},{default:Z(()=>[e("div",Fn,[e("div",Rn,[e("label",null,[T(s(n(o)("config.modelConfig.type"))+" ",1),a[20]||(a[20]=e("span",{class:"required"},"*",-1))]),C(xe,{modelValue:w.type,"onUpdate:modelValue":a[5]||(a[5]=l=>w.type=l),options:d.map(l=>({id:l,name:l})),placeholder:n(o)("config.modelConfig.typePlaceholder"),"dropdown-title":n(o)("config.modelConfig.typePlaceholder"),icon:"carbon:types"},null,8,["modelValue","options","placeholder","dropdown-title"])]),e("div",Dn,[e("label",null,[T(s(n(o)("config.modelConfig.baseUrl"))+" ",1),a[21]||(a[21]=e("span",{class:"required"},"*",-1))]),j(e("input",{type:"text","onUpdate:modelValue":a[6]||(a[6]=l=>w.baseUrl=l),placeholder:n(o)("config.modelConfig.baseUrlPlaceholder"),required:""},null,8,Ln),[[J,w.baseUrl]])]),e("div",In,[e("label",null,[T(s(n(o)("config.modelConfig.apiKey"))+" ",1),a[22]||(a[22]=e("span",{class:"required"},"*",-1))]),j(e("input",{type:"text","onUpdate:modelValue":a[7]||(a[7]=l=>w.apiKey=l),placeholder:n(o)("config.modelConfig.apiKeyPlaceholder"),required:""},null,8,On),[[J,w.apiKey]])]),e("div",qn,[e("label",null,[T(s(n(o)("config.modelConfig.modelName"))+" ",1),a[23]||(a[23]=e("span",{class:"required"},"*",-1))]),j(e("input",{type:"text","onUpdate:modelValue":a[8]||(a[8]=l=>w.modelName=l),placeholder:n(o)("config.modelConfig.modelNamePlaceholder"),required:""},null,8,jn),[[J,w.modelName]])]),e("div",Gn,[e("label",null,[T(s(n(o)("config.modelConfig.description"))+" ",1),a[24]||(a[24]=e("span",{class:"required"},"*",-1))]),j(e("textarea",{"onUpdate:modelValue":a[9]||(a[9]=l=>w.modelDescription=l),rows:"3",placeholder:n(o)("config.modelConfig.descriptionPlaceholder"),required:""},null,8,Kn),[[J,w.modelDescription]])])])]),_:1},8,["modelValue","title"]),C(pe,{modelValue:V.value,"onUpdate:modelValue":a[12]||(a[12]=l=>V.value=l),title:"删除确认"},{footer:Z(()=>[e("button",{class:"cancel-btn",onClick:a[11]||(a[11]=l=>V.value=!1)},s(n(o)("common.cancel")),1),e("button",{class:"confirm-btn danger",onClick:F},s(n(o)("common.delete")),1)]),default:Z(()=>{var l;return[e("div",Jn,[C(n(E),{icon:"carbon:warning",class:"warning-icon"}),e("p",null,[T(s(n(o)("config.modelConfig.deleteConfirmText"))+" ",1),e("strong",null,s((l=h.value)==null?void 0:l.modelName),1),T(" "+s(n(o)("common.confirm"))+"？",1)]),e("p",zn,s(n(o)("config.modelConfig.deleteWarning")),1)])]}),_:1},8,["modelValue"]),m.value?(i(),c("div",{key:0,class:"error-toast",onClick:a[13]||(a[13]=l=>m.value="")},[C(n(E),{icon:"carbon:error"}),T(" "+s(m.value),1)])):N("",!0),b.value?(i(),c("div",{key:1,class:"success-toast",onClick:a[14]||(a[14]=l=>b.value="")},[C(n(E),{icon:"carbon:checkmark"}),T(" "+s(b.value),1)])):N("",!0)]))}}),Xn=ce(Hn,[["__scopeId","data-v-e7941263"]]);class me{static async handleResponse(o){if(!o.ok)try{const t=await o.json();throw new Error(t.message||`API request failed: ${o.status}`)}catch{throw new Error(`API request failed: ${o.status} ${o.statusText}`)}return o}static async getAllNamespaces(){try{const o=await fetch(this.BASE_URL);return await(await this.handleResponse(o)).json()}catch(o){throw console.error("Failed to get Namespace list:",o),o}}static async getAllCodes(){try{const o=await fetch(`${this.BASE_URL}/codes`);return await(await this.handleResponse(o)).json()}catch(o){throw console.error("Failed to get Namespace codes list:",o),o}}static async getNamespaceById(o){try{const t=await fetch(`${this.BASE_URL}/${o}`);return await(await this.handleResponse(t)).json()}catch(t){throw console.error(`Failed to get Namespace[${o}] details:`,t),t}}static async getNamespaceByCode(o){try{const t=await fetch(`${this.BASE_URL}/code/${o}`);return await(await this.handleResponse(t)).json()}catch(t){throw console.error(`Failed to get Namespace[${o}] details:`,t),t}}static async createNamespace(o){try{const t=await fetch(this.BASE_URL,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});return await(await this.handleResponse(t)).json()}catch(t){throw console.error("Failed to create Namespace:",t),t}}static async updateNamespace(o,t){try{const m=await fetch(`${this.BASE_URL}/${o}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});return await(await this.handleResponse(m)).json()}catch(m){throw console.error(`Failed to update Namespace[${o}]:`,m),m}}static async deleteNamespace(o){try{const t=await fetch(`${this.BASE_URL}/${o}`,{method:"DELETE"});if(t.status===400)throw new Error("Cannot delete default Namespace");await this.handleResponse(t)}catch(t){throw console.error(`Failed to delete Namespace[${o}]:`,t),t}}}fe(me,"BASE_URL","/api/namespaces");const Yn={class:"config-panel"},Wn={class:"panel-header"},Qn={class:"namespace-layout"},Zn={class:"namespace-list"},ea={class:"list-header"},oa={class:"namespace-count"},ta={key:0,class:"namespaces-container"},sa=["onClick"],na={class:"namespace-card-header"},aa={class:"namespace-name"},la={class:"namespace-desc"},ia={class:"namespace-code"},ca={class:"namespace-tag"},ra={key:1,class:"loading-state"},da={key:2,class:"empty-state"},ua={key:0,class:"namespace-detail"},pa={class:"detail-header"},ga={class:"detail-actions"},fa={class:"form-item"},ma=["placeholder"],va={class:"form-item"},ha=["placeholder"],ya={class:"form-item"},_a=["placeholder"],ba={key:1,class:"no-selection"},$a={class:"modal-form"},Ca={class:"form-item"},wa=["placeholder"],ka={class:"form-item"},Sa=["placeholder"],Ta={class:"form-item"},Aa=["placeholder"],xa={class:"delete-confirm"},Ea={class:"warning-text"},Ma=re({__name:"namespaceConfig",setup(K){const{t:o}=ve(),t=R(!1),m=R(""),b=R(""),p=ne([]),d=R(null),h=R(!1),M=R(!1),V=ne({name:"",code:"",description:""}),w=(F,g)=>{g==="success"?(b.value=F,setTimeout(()=>{b.value=""},3e3)):(m.value=F,setTimeout(()=>{m.value=""},5e3))},U=async()=>{t.value=!0;try{const g=(await me.getAllNamespaces()).map(P=>({...P}));p.splice(0,p.length,...g),g.length>0&&await z(g[0])}catch(F){console.error("加载数据失败:",F),w(o("config.namespaceConfig.loadDataFailed")+": "+F.message,"error")}finally{t.value=!1}},z=async F=>{try{const g=await me.getNamespaceById(F.id);d.value={...g}}catch(g){console.error("加载Namespace详情失败:",g),w(o("config.namespaceConfig.loadDetailsFailed")+": "+g.message,"error"),d.value={...F}}},Q=()=>{V.name="",V.code="",V.description="",h.value=!0},te=async()=>{if(!V.name.trim()||!V.code.trim()||!V.description.trim()){w(o("config.namespaceConfig.requiredFields"),"error");return}try{const F={name:V.name.trim(),code:V.code.trim(),description:V.description.trim()},g=await me.createNamespace(F);p.push(g),d.value=g,h.value=!1,w(o("config.namespaceConfig.createSuccess"),"success")}catch(F){w(o("config.namespaceConfig.createFailed")+": "+F.message,"error")}},L=async()=>{if(d.value){if(!d.value.name.trim()||!d.value.code.trim()||!d.value.description.trim()){w(o("config.namespaceConfig.requiredFields"),"error");return}try{const F=await me.updateNamespace(d.value.id,d.value),g=p.findIndex(P=>P.id===F.id);g!==-1&&(p[g]=F),d.value=F,w(o("config.namespaceConfig.saveSuccess"),"success")}catch(F){w(o("config.namespaceConfig.saveFailed")+": "+F.message,"error")}}},v=()=>{M.value=!0},q=async()=>{if(d.value)try{await me.deleteNamespace(d.value.id);const F=p.findIndex(g=>g.id===d.value.id);F!==-1&&p.splice(F,1),d.value=p.length>0?p[0]:null,M.value=!1,w(o("config.namespaceConfig.deleteSuccess"),"success")}catch(F){w(o("config.namespaceConfig.deleteFailed")+": "+F.message,"error")}};return _e(()=>{U()}),(F,g)=>(i(),c("div",Yn,[e("div",Wn,[e("h2",null,s(n(o)("config.namespaceConfig.title")),1)]),e("div",Qn,[e("div",Zn,[e("div",ea,[e("h3",null,s(n(o)("config.namespaceConfig.configuredNamespaces")),1),e("span",oa,"("+s(p.length)+")",1)]),t.value?N("",!0):(i(),c("div",ta,[(i(!0),c(Y,null,W(p,P=>{var x;return i(),c("div",{key:P.id,class:oe(["namespace-card",{active:((x=d.value)==null?void 0:x.id)===P.id}]),onClick:a=>z(P)},[e("div",na,[e("span",aa,s(P.name),1),C(n(E),{icon:"carbon:chevron-right"})]),e("p",la,s(P.description),1),e("div",ia,[e("span",ca,s(P.code),1)])],10,sa)}),128))])),t.value?(i(),c("div",ra,[C(n(E),{icon:"carbon:loading",class:"loading-icon"}),T(" "+s(n(o)("common.loading")),1)])):N("",!0),!t.value&&p.length===0?(i(),c("div",da,[C(n(E),{icon:"carbon:folder",class:"empty-icon"}),e("p",null,s(n(o)("config.namespaceConfig.noNamespace")),1)])):N("",!0),e("button",{class:"add-btn",onClick:Q},[C(n(E),{icon:"carbon:add"}),T(" "+s(n(o)("config.namespaceConfig.createNew")),1)])]),d.value?(i(),c("div",ua,[e("div",pa,[e("h3",null,s(d.value.name),1),e("div",ga,[e("button",{class:"action-btn primary",onClick:L},[C(n(E),{icon:"carbon:save"}),T(" "+s(n(o)("common.save")),1)]),e("button",{class:"action-btn danger",onClick:v},[C(n(E),{icon:"carbon:trash-can"}),T(" "+s(n(o)("common.delete")),1)])])]),e("div",fa,[e("label",null,[T(s(n(o)("config.namespaceConfig.name"))+" ",1),g[11]||(g[11]=e("span",{class:"required"},"*",-1))]),j(e("input",{type:"text","onUpdate:modelValue":g[0]||(g[0]=P=>d.value.name=P),placeholder:n(o)("config.namespaceConfig.namePlaceholder"),required:""},null,8,ma),[[J,d.value.name]])]),e("div",va,[e("label",null,[T(s(n(o)("config.namespaceConfig.code"))+" ",1),g[12]||(g[12]=e("span",{class:"required"},"*",-1))]),j(e("input",{type:"text","onUpdate:modelValue":g[1]||(g[1]=P=>d.value.code=P),placeholder:n(o)("config.namespaceConfig.codePlaceholder"),required:""},null,8,ha),[[J,d.value.code]])]),e("div",ya,[e("label",null,[T(s(n(o)("config.namespaceConfig.description"))+" ",1),g[13]||(g[13]=e("span",{class:"required"},"*",-1))]),j(e("textarea",{"onUpdate:modelValue":g[2]||(g[2]=P=>d.value.description=P),rows:"3",placeholder:n(o)("config.namespaceConfig.descriptionPlaceholder"),required:""},null,8,_a),[[J,d.value.description]])])])):(i(),c("div",ba,[C(n(E),{icon:"carbon:folder",class:"placeholder-icon"}),e("p",null,s(n(o)("config.namespaceConfig.selectNamespaceHint")),1)]))]),C(pe,{modelValue:h.value,"onUpdate:modelValue":g[6]||(g[6]=P=>h.value=P),title:n(o)("config.namespaceConfig.newNamespace"),onConfirm:te},{default:Z(()=>[e("div",$a,[e("div",Ca,[e("label",null,[T(s(n(o)("config.namespaceConfig.name"))+" ",1),g[14]||(g[14]=e("span",{class:"required"},"*",-1))]),j(e("input",{type:"text","onUpdate:modelValue":g[3]||(g[3]=P=>V.name=P),placeholder:n(o)("config.namespaceConfig.namePlaceholder"),required:""},null,8,wa),[[J,V.name]])]),e("div",ka,[e("label",null,[T(s(n(o)("config.namespaceConfig.code"))+" ",1),g[15]||(g[15]=e("span",{class:"required"},"*",-1))]),j(e("input",{type:"text","onUpdate:modelValue":g[4]||(g[4]=P=>V.code=P),placeholder:n(o)("config.namespaceConfig.codePlaceholder"),required:""},null,8,Sa),[[J,V.code]])]),e("div",Ta,[e("label",null,[T(s(n(o)("config.namespaceConfig.description"))+" ",1),g[16]||(g[16]=e("span",{class:"required"},"*",-1))]),j(e("textarea",{"onUpdate:modelValue":g[5]||(g[5]=P=>V.description=P),rows:"3",placeholder:n(o)("config.namespaceConfig.descriptionPlaceholder"),required:""},null,8,Aa),[[J,V.description]])])])]),_:1},8,["modelValue","title"]),C(pe,{modelValue:M.value,"onUpdate:modelValue":g[8]||(g[8]=P=>M.value=P),title:"删除确认"},{footer:Z(()=>[e("button",{class:"cancel-btn",onClick:g[7]||(g[7]=P=>M.value=!1)},s(n(o)("common.cancel")),1),e("button",{class:"confirm-btn danger",onClick:q},s(n(o)("common.delete")),1)]),default:Z(()=>{var P;return[e("div",xa,[C(n(E),{icon:"carbon:warning",class:"warning-icon"}),e("p",null,[T(s(n(o)("config.namespaceConfig.deleteConfirmText"))+" ",1),e("strong",null,s((P=d.value)==null?void 0:P.name),1),T(" "+s(n(o)("common.confirm"))+"？",1)]),e("p",Ea,s(n(o)("config.namespaceConfig.deleteWarning")),1)])]}),_:1},8,["modelValue"]),m.value?(i(),c("div",{key:0,class:"error-toast",onClick:g[9]||(g[9]=P=>m.value="")},[C(n(E),{icon:"carbon:error"}),T(" "+s(m.value),1)])):N("",!0),b.value?(i(),c("div",{key:1,class:"success-toast",onClick:g[10]||(g[10]=P=>b.value="")},[C(n(E),{icon:"carbon:checkmark"}),T(" "+s(b.value),1)])):N("",!0)]))}}),Ua=ce(Ma,[["__scopeId","data-v-b2fc09ed"]]);class $e{static async getAllMcpServers(){const o=await fetch(`${this.BASE_URL}/list`);if(!o.ok)throw new Error(`Failed to get MCP server list: ${o.status}`);return await o.json()}static async addMcpServer(o){try{const t=await fetch(`${this.BASE_URL}/add`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});if(!t.ok)throw new Error(`Failed to add MCP server: ${t.status}`);return{success:!0,message:"Successfully added MCP server"}}catch(t){return console.error("Failed to add MCP server:",t),{success:!1,message:t instanceof Error?t.message:"Failed to add, please retry"}}}static async removeMcpServer(o){try{const t=await fetch(`${this.BASE_URL}/remove?id=${o}`);if(!t.ok)throw new Error(`Failed to delete MCP server: ${t.status}`);return{success:!0,message:"Successfully deleted MCP server"}}catch(t){return console.error(`Failed to delete MCP server[${o}]:`,t),{success:!1,message:t instanceof Error?t.message:"Failed to delete, please retry"}}}}fe($e,"BASE_URL","/api/mcp");const Va={class:"mcp-config-panel"},Na={class:"mcp-header"},Pa={class:"header-left"},Ba={class:"mcp-stats"},Fa={class:"stat-item"},Ra={class:"stat-value"},Da={class:"header-right"},La={class:"search-box"},Ia={key:0,class:"loading-container"},Oa={key:1,class:"mcp-layout"},qa={class:"mcp-table-container"},ja={key:0,class:"empty-state"},Ga={class:"empty-state-text"},Ka={key:1,class:"mcp-table-wrapper"},Ja={class:"mcp-table"},za={class:"mcp-id"},Ha={class:"mcp-server-name"},Xa={class:"server-name-content"},Ya={class:"mcp-connection-type"},Wa={class:"mcp-config"},Qa=["title"],Za={class:"mcp-actions"},el=["onClick","disabled"],ol={class:"add-mcp-container"},tl={class:"mcp-form"},sl={class:"mcp-form-group"},nl={class:"connection-type-options"},al={class:"connection-type-option"},ll={class:"connection-type-option"},il={class:"mcp-form-group"},cl=["placeholder"],rl={class:"mcp-form-actions"},dl=["disabled"],ul=["disabled"],pl=re({__name:"mcpConfig",setup(K){const{t:o}=ve(),t=R(!1),m=R([]),b=R(""),p=ne({connectionType:"STUDIO",configJson:""}),d=ne({show:!1,text:"",type:"success"}),h=ae(()=>p.configJson.trim().length>0),M=ae(()=>{if(!b.value.trim())return m.value;const L=b.value.toLowerCase();return m.value.filter(v=>v.mcpServerName.toLowerCase().includes(L)||v.connectionType.toLowerCase().includes(L)||v.connectionConfig.toLowerCase().includes(L))}),V=L=>L?L.length>50?L.substring(0,50)+"...":L:"",w=(L,v="success")=>{d.text=L,d.type=v,d.show=!0,setTimeout(()=>{d.show=!1},3e3)},U=async()=>{try{t.value=!0,m.value=await $e.getAllMcpServers()}catch(L){console.error("加载MCP服务器列表失败:",L),w("加载MCP服务器列表失败","error")}finally{t.value=!1}},z=async()=>{if(!h.value){w(o("config.mcpConfig.configRequired"),"error");return}try{JSON.parse(p.configJson)}catch{w(o("config.mcpConfig.invalidJson"),"error");return}try{t.value=!0;const L={connectionType:p.connectionType,configJson:p.configJson},v=await $e.addMcpServer(L);v.success?(w("添加MCP服务器成功"),te(),await U()):w(v.message||o("config.mcpConfig.addFailed"),"error")}catch(L){console.error("添加MCP服务器失败:",L),w(o("config.mcpConfig.addFailed"),"error")}finally{t.value=!1}},Q=async L=>{if(confirm("确定要删除这个MCP服务器配置吗？此操作不可恢复。"))try{t.value=!0;const v=await $e.removeMcpServer(L);v.success?(w("删除MCP服务器成功"),await U()):w(v.message||o("config.mcpConfig.deleteFailed"),"error")}catch(v){console.error("删除MCP服务器失败:",v),w(o("config.mcpConfig.deleteFailed"),"error")}finally{t.value=!1}},te=()=>{p.connectionType="STUDIO",p.configJson=""};return _e(()=>{U()}),(L,v)=>(i(),c("div",Va,[e("div",Na,[e("div",Pa,[v[5]||(v[5]=e("h2",null,"MCP配置",-1)),e("div",Ba,[e("span",Fa,[v[4]||(v[4]=e("span",{class:"stat-label"},"总服务器:",-1)),e("span",Ra,s(m.value.length),1)])])]),e("div",Da,[e("div",La,[j(e("input",{"onUpdate:modelValue":v[0]||(v[0]=q=>b.value=q),type:"text",placeholder:"搜索MCP服务器...",class:"search-input"},null,512),[[J,b.value]]),v[6]||(v[6]=e("span",{class:"search-icon"},"🔍",-1))])])]),t.value?(i(),c("div",Ia,v[7]||(v[7]=[e("div",{class:"loading-spinner"},null,-1),e("p",null,"正在加载MCP服务器...",-1)]))):(i(),c("div",Oa,[e("div",qa,[v[11]||(v[11]=e("h3",{class:"section-title"},"已配置的MCP服务器",-1)),M.value.length===0?(i(),c("div",ja,[v[8]||(v[8]=e("div",{class:"empty-state-icon"},"📂",-1)),e("div",Ga,s(b.value?"未找到匹配的MCP服务器":"暂无MCP服务器配置"),1)])):(i(),c("div",Ka,[e("table",Ja,[v[10]||(v[10]=e("thead",null,[e("tr",null,[e("th",null,"ID"),e("th",null,"服务器名称"),e("th",null,"连接类型"),e("th",null,"连接配置"),e("th",null,"操作")])],-1)),e("tbody",null,[(i(!0),c(Y,null,W(M.value,q=>(i(),c("tr",{key:q.id,class:"mcp-row"},[e("td",za,s(q.id),1),e("td",Ha,[e("div",Xa,[v[9]||(v[9]=e("span",{class:"server-icon"},"🔌",-1)),T(" "+s(q.mcpServerName),1)])]),e("td",Ya,[e("span",{class:oe(["connection-type-badge",q.connectionType.toLowerCase()])},s(q.connectionType),3)]),e("td",Wa,[e("div",{class:"config-preview",title:q.connectionConfig},s(V(q.connectionConfig)),9,Qa)]),e("td",Za,[e("button",{onClick:F=>Q(q.id),class:"action-btn delete-btn",disabled:t.value}," 删除 ",8,el)])]))),128))])])]))]),e("div",ol,[v[16]||(v[16]=e("div",{class:"add-mcp-header"},[e("h3",{class:"add-mcp-title"},"添加MCP服务器")],-1)),e("div",tl,[e("div",sl,[v[14]||(v[14]=e("label",{class:"form-label"},"连接类型：",-1)),e("div",nl,[e("div",al,[j(e("input",{type:"radio",id:"mcp-connection-type-studio","onUpdate:modelValue":v[1]||(v[1]=q=>p.connectionType=q),value:"STUDIO"},null,512),[[Ae,p.connectionType]]),v[12]||(v[12]=e("label",{for:"mcp-connection-type-studio",class:"radio-label"},[e("span",{class:"radio-title"},"STUDIO"),e("span",{class:"connection-type-desc"},"本地mcp server，目前市面上主流的是这个")],-1))]),e("div",ll,[j(e("input",{type:"radio",id:"mcp-connection-type-sse","onUpdate:modelValue":v[2]||(v[2]=q=>p.connectionType=q),value:"SSE"},null,512),[[Ae,p.connectionType]]),v[13]||(v[13]=e("label",{for:"mcp-connection-type-sse",class:"radio-label"},[e("span",{class:"radio-title"},"SSE"),e("span",{class:"connection-type-desc"},"通过http server等提供的，目前网络上比较少见")],-1))])])]),e("div",il,[v[15]||(v[15]=e("label",{class:"form-label"},"mcp json配置：",-1)),j(e("textarea",{"onUpdate:modelValue":v[3]||(v[3]=q=>p.configJson=q),placeholder:n(o)("config.mcpConfig.configJsonPlaceholder"),class:"config-textarea",rows:"6"},null,8,cl),[[J,p.configJson]])]),e("div",rl,[e("button",{onClick:z,class:"action-btn add-btn",disabled:t.value},s(n(o)("common.add")),9,dl),e("button",{onClick:te,class:"action-btn reset-btn",disabled:t.value},s(n(o)("common.reset")),9,ul)])]),v[17]||(v[17]=Re('<div class="mcp-form-instructions" data-v-0ed0ce1e><h4 data-v-0ed0ce1e>使用说明：</h4><ol data-v-0ed0ce1e><li data-v-0ed0ce1e>找到你要用的mcp server的配置json： <ul class="indented-list" data-v-0ed0ce1e><li data-v-0ed0ce1e><strong data-v-0ed0ce1e>本地(STDIO)</strong>：可以在<a href="https://mcp.so" target="_blank" rel="noopener" data-v-0ed0ce1e>mcp.so</a>上找到，需要你有Node.js环境并理解你要配置的json里面的每一个项，做对应调整比如配置ak</li><li data-v-0ed0ce1e><strong data-v-0ed0ce1e>远程服务(SSE)</strong>：<a href="https://mcp.higress.ai/" target="_blank" rel="noopener" data-v-0ed0ce1e>mcp.higress.ai/</a>上可以找到，有SSE和STREAMING两种，目前SSE协议更完备一些</li></ul></li><li data-v-0ed0ce1e>将json配置复制到上面的输入框，本地选STUDIO，远程选STREAMING或SSE，提交</li><li data-v-0ed0ce1e>这样mcp tools就注册成功了。</li><li data-v-0ed0ce1e>然后需要在Agent配置里面，新建一个agent，然后增加指定你刚才添加的mcp tools，这样可以极大减少冲突，增强tools被agent选择的准确性</li></ol></div>',1))])])),C(Ce,{name:"message-fade"},{default:Z(()=>[d.show?(i(),c("div",{key:0,class:oe(["message-toast",d.type])},s(d.text),3)):N("",!0)]),_:1})]))}}),gl=ce(pl,[["__scopeId","data-v-0ed0ce1e"]]),fl={class:"config-container"},ml={class:"config-header"},vl={class:"header-actions"},hl={class:"config-content"},yl={class:"config-nav"},_l=["onClick"],bl={class:"config-details"},$l=re({__name:"index",setup(K){const{t:o}=ve(),t=R("basic"),m=ae(()=>[{key:"basic",label:o("config.categories.basic"),icon:"carbon:settings"},{key:"agent",label:o("config.categories.agent"),icon:"carbon:bot"},{key:"model",label:o("config.categories.model"),icon:"carbon:build-image"},{key:"namespace",label:o("config.categories.namespace"),icon:"carbon:folder"},{key:"mcp",label:o("config.categories.mcp"),icon:"carbon:tool-box"}]);return(b,p)=>(i(),c("div",fl,[e("div",ml,[e("div",vl,[e("button",{class:"action-btn",onClick:p[0]||(p[0]=d=>b.$router.push("/"))},[C(n(E),{icon:"carbon:arrow-left"}),T(" "+s(b.$t("backHome")),1)]),C(De)])]),e("div",hl,[e("nav",yl,[(i(!0),c(Y,null,W(m.value,(d,h)=>(i(),c("div",{key:h,class:oe(["nav-item",{active:t.value===d.key}]),onClick:M=>t.value=d.key},[C(n(E),{icon:d.icon,width:"20"},null,8,["icon"]),e("span",null,s(d.label),1)],10,_l))),128))]),e("div",bl,[t.value==="basic"?(i(),ie(ft,{key:0})):N("",!0),t.value==="agent"?(i(),ie(Hs,{key:1})):N("",!0),t.value==="model"?(i(),ie(Xn,{key:2})):N("",!0),t.value==="namespace"?(i(),ie(Ua,{key:3})):N("",!0),t.value==="mcp"?(i(),ie(gl,{key:4})):N("",!0)])])]))}}),Tl=ce($l,[["__scopeId","data-v-04ec4b64"]]);export{Tl as default};
