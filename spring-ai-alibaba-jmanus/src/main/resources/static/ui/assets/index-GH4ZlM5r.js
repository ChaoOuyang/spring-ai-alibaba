var Ve=Object.defineProperty;var Ne=(j,o,t)=>o in j?Ve(j,o,{enumerable:!0,configurable:!0,writable:!0,value:t}):j[o]=t;var fe=(j,o,t)=>Ne(j,typeof o!="symbol"?o+"":o,t);import{_ as ce,I as x}from"./_plugin-vue_export-helper-BNmJQJx7.js";import{d as re,c as r,o as i,e,t as s,f as ve,r as P,x as ne,g as ae,h as _e,i as b,u as n,b as V,q as k,w as O,v as K,F as X,j as Y,p as oe,C as Ee,a as ie,z as Q,T as $e,D as Pe,E as Te,s as ye,B as ke,G as Be,k as Fe,H as Re,I as Ae}from"./index-DVgXVFo0.js";import{L as De}from"./index-Cp8VPxfW.js";const Le={class:"switch"},Ie=["checked"],Oe={class:"switch-label"},qe=re({__name:"index",props:{enabled:{type:Boolean},label:{}},emits:["update:switchValue"],setup(j,{emit:o}){const t=o,m=C=>{const g=C.target.checked;t("update:switchValue",g)};return(C,g)=>(i(),r("label",Le,[e("input",{type:"checkbox",checked:C.enabled,onChange:m},null,40,Ie),g[0]||(g[0]=e("span",{class:"slider"},null,-1)),e("span",Oe,s(C.label),1)]))}}),je=ce(qe,[["__scopeId","data-v-d484b4a3"]]);class he{static async getConfigsByGroup(o){try{const t=await fetch(`${this.BASE_URL}/group/${o}`);if(!t.ok)throw new Error(`Failed to get ${o} group configuration: ${t.status}`);return await t.json()}catch(t){throw console.error(`Failed to get ${o} group configuration:`,t),t}}static async batchUpdateConfigs(o){if(o.length===0)return{success:!0,message:"No configuration needs to be updated"};try{const t=await fetch(`${this.BASE_URL}/batch-update`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});if(!t.ok)throw new Error(`Batch update configuration failed: ${t.status}`);return{success:!0,message:"Configuration saved successfully"}}catch(t){return console.error("Batch update configuration failed:",t),{success:!1,message:t instanceof Error?t.message:"Update failed, please try again"}}}static async getConfigById(o){try{const t=await fetch(`${this.BASE_URL}/${o}`);if(!t.ok)throw new Error(`Failed to get configuration item: ${t.status}`);return await t.json()}catch(t){throw console.error(`Failed to get configuration item[${o}]:`,t),t}}static async updateConfig(o){try{const t=await fetch(`${this.BASE_URL}/${o.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});if(!t.ok)throw new Error(`Failed to update configuration item: ${t.status}`);return{success:!0,message:"Configuration updated successfully"}}catch(t){return console.error("Failed to update configuration item:",t),{success:!1,message:t instanceof Error?t.message:"Update failed, please try again"}}}}fe(he,"BASE_URL","/api/config");const Ge={class:"config-panel"},Ke={class:"config-header"},Je={class:"header-left"},ze={class:"config-stats"},He={class:"stat-item"},Xe={class:"stat-value"},Ye={key:0,class:"stat-item"},We={class:"stat-value modified"},Qe={class:"header-right"},Ze={class:"import-export-actions"},eo={class:"action-btn",title:"导入配置"},oo={class:"search-box"},to=["placeholder"],so={key:0,class:"loading-container"},no={key:1,class:"config-groups"},ao={class:"group-header"},lo={class:"group-info"},io={class:"group-icon"},co={class:"group-actions"},ro=["onClick","disabled","title"],uo={class:"sub-groups"},po=["onClick"],go={class:"sub-group-info"},fo={class:"sub-group-title"},mo={class:"item-count"},vo={class:"config-items"},ho={key:0,class:"config-item-content vertical-layout"},yo={class:"config-item-info"},_o={class:"config-item-header"},bo={class:"config-label"},Co={class:"type-badge boolean"},$o={key:0,class:"modified-badge"},wo=["title"],ko={class:"config-control"},So=["value","onChange"],To=["value"],Ao={key:1,class:"config-item-content vertical-layout"},xo={class:"config-item-info"},Eo={class:"config-item-header"},Mo={class:"config-label"},Uo={class:"type-badge select"},Vo={key:0,class:"modified-badge"},No=["title"],Po={class:"config-control"},Bo=["value","onChange"],Fo=["value"],Ro={key:2,class:"config-item-content vertical-layout"},Do={class:"config-item-info"},Lo={class:"config-item-header"},Io={class:"config-label"},Oo={class:"type-badge textarea"},qo={key:0,class:"modified-badge"},jo=["title"],Go={class:"config-control"},Ko=["value","onInput"],Jo={key:3,class:"config-item-content vertical-layout"},zo={class:"config-item-info"},Ho={class:"config-item-header"},Xo={class:"config-label"},Yo={class:"type-badge number"},Wo={key:0,class:"modified-badge"},Qo=["title"],Zo={key:0,class:"config-meta"},et={class:"range-info"},ot={class:"config-control"},tt=["value","onInput","min","max"],st={key:4,class:"config-item-content vertical-layout"},nt={class:"config-item-info"},at={class:"config-item-header"},lt={class:"config-label"},it={class:"type-badge string"},ct={key:0,class:"modified-badge"},rt=["title"],dt={class:"config-control"},ut=["value","onInput"],pt={key:2,class:"empty-state"},gt=re({__name:"basicConfig",setup(j){const{t:o}=ve(),t=P(!0),m=P(!1),C=P([]),g=P(new Map),u=P(new Set),h=ne({show:!1,text:"",type:"success"}),E=P(""),U={maxSteps:"智能体执行最大步数",resetAllAgents:"重置所有agent",maxMemory:"能记住的最大消息数",headlessBrowser:"是否使用无头浏览器模式",browserTimeout:o("config.basicConfig.browserTimeout"),browserDebug:"浏览器debug模式",autoOpenBrowser:"启动时自动打开浏览器",consoleInteractive:"启用控制台交互模式",systemName:"系统名称",language:"默认语言",maxThreads:"最大线程数",timeoutSeconds:o("config.basicConfig.requestTimeout")},$={manus:"智能体设置",browser:"浏览器设置",interaction:"交互设置",system:"系统设置",performance:"性能设置"},M={manus:"🤖",browser:"🌐",interaction:"🖥️",system:"⚙️",performance:"⚡"},J={agent:"智能体设置",browser:"浏览器设置",interaction:"交互设置",system:"系统设置",performance:"性能设置",general:"常规设置"},W=ae(()=>C.value.some(d=>d.subGroups.some(_=>_.items.some(S=>g.value.get(S.id)!==S.configValue)))),te=d=>d==="true",R=d=>parseFloat(d)||0,v=d=>({maxSteps:1,browserTimeout:1,maxThreads:1,timeoutSeconds:5,maxMemory:1})[d]||1,I=d=>({maxSteps:100,browserTimeout:600,maxThreads:32,timeoutSeconds:300,maxMemory:1e3})[d]||1e4,Z=d=>typeof d=="string"?d:d.value,G=d=>typeof d=="string"?d:d.label,F=(d,_)=>{if(typeof _=="boolean")return _.toString();if(typeof _=="string"){if(d.options&&d.options.length>0){const S=d.options.find(T=>(typeof T=="string"?T:T.label)===_||(typeof T=="string"?T:T.value)===_);if(S)return typeof S=="string"?S:S.value}return _}return String(_)},c=(d,_,S=!1)=>{let T;d.inputType==="BOOLEAN"||d.inputType==="CHECKBOX"?T=F(d,_):T=String(_),d.configValue!==T&&(d.configValue=T,d._modified=!0,(S||d.inputType==="BOOLEAN"||d.inputType==="CHECKBOX"||d.inputType==="SELECT")&&l())};let a=null;const l=()=>{a&&clearTimeout(a),a=window.setTimeout(()=>{D()},500)},y=(d,_="success")=>{h.text=d,h.type=_,h.show=!0,setTimeout(()=>{h.show=!1},3e3)},L=async()=>{try{t.value=!0;const _=["manus","browser","interaction","system","performance"].map(async T=>{try{const p=await he.getConfigsByGroup(T);if(p.length===0)return null;const N=p.map(z=>({...z,displayName:z.description??(U[z.configKey]||z.configKey),min:v(z.configKey),max:I(z.configKey)}));N.forEach(z=>{g.value.set(z.id,z.configValue)});const B=new Map;N.forEach(z=>{const le=z.configSubGroup??"general";B.has(le)||B.set(le,[]),B.get(le).push(z)});const ee=Array.from(B.entries()).map(([z,le])=>({name:z,displayName:J[z]||z,items:le}));return{name:T,displayName:$[T]||T,subGroups:ee}}catch(p){return console.warn(`加载配置组 ${T} 失败，跳过:`,p),null}}),S=await Promise.all(_);C.value=S.filter(T=>T!==null),console.log("配置加载完成:",C.value)}catch(d){console.error("加载配置失败:",d),y(o("config.basicConfig.loadConfigFailed"),"error")}finally{t.value=!1}},D=async()=>{if(!(m.value||!W.value))try{m.value=!0;const d=[];if(C.value.forEach(S=>{S.subGroups.forEach(T=>{const p=T.items.filter(N=>N._modified);d.push(...p)})}),d.length===0){y("没有需要保存的修改");return}const _=await he.batchUpdateConfigs(d);_.success?(d.forEach(S=>{g.value.set(S.id,S.configValue),S._modified=!1}),y("配置保存成功")):y(_.message||"保存失败","error")}catch(d){console.error("保存配置失败:",d),y(o("config.basicConfig.saveFailed"),"error")}finally{m.value=!1}},H=async d=>{if(confirm(`确定要重置 "${$[d]||d}" 组的所有配置吗？`))try{m.value=!0;const S=C.value.find(N=>N.name===d);if(!S)return;const T=[];if(S.subGroups.forEach(N=>{N.items.forEach(B=>{const ee=se(B.configKey);ee!==B.configValue&&T.push({...B,configValue:ee})})}),T.length===0){y("该组配置已是默认值");return}const p=await he.batchUpdateConfigs(T);p.success?(await L(),y(`成功重置 ${T.length} 项配置`)):y(p.message||"重置失败","error")}catch(S){console.error("重置组配置失败:",S),y(o("config.basicConfig.resetFailed"),"error")}finally{m.value=!1}},se=d=>({systemName:"JTaskPilot",language:"zh-CN",maxThreads:"8",timeoutSeconds:"60",autoOpenBrowser:"false",headlessBrowser:"true",maxMemory:"1000"})[d]||"",be=(d,_)=>{const S=`${d}-${_}`;u.value.has(S)?u.value.delete(S):u.value.add(S)},ge=(d,_)=>u.value.has(`${d}-${_}`),A=ae(()=>{const d=C.value.reduce((S,T)=>S+T.subGroups.reduce((p,N)=>p+N.items.length,0),0),_=C.value.reduce((S,T)=>S+T.subGroups.reduce((p,N)=>p+N.items.filter(B=>g.value.get(B.id)!==B.configValue).length,0),0);return{total:d,modified:_}}),f=ae(()=>{if(!E.value.trim())return C.value;const d=E.value.toLowerCase();return C.value.map(_=>({..._,subGroups:_.subGroups.map(S=>({...S,items:S.items.filter(T=>T.displayName.toLowerCase().includes(d)||T.configKey.toLowerCase().includes(d)||T.description&&T.description.toLowerCase().includes(d))})).filter(S=>S.items.length>0)})).filter(_=>_.subGroups.length>0)}),q=()=>{try{const d={timestamp:new Date().toISOString(),version:"1.0",configs:C.value.reduce((p,N)=>(N.subGroups.forEach(B=>{B.items.forEach(ee=>{p[ee.configKey]=ee.configValue})}),p),{})},_=JSON.stringify(d,null,2),S=new Blob([_],{type:"application/json"}),T=document.createElement("a");T.href=URL.createObjectURL(S),T.download=`config-export-${new Date().toISOString().split("T")[0]}.json`,T.click(),y("配置导出成功")}catch(d){console.error("导出配置失败:",d),y("导出失败","error")}},w=d=>{var p;const _=d.target,S=(p=_.files)==null?void 0:p[0];if(!S)return;const T=new FileReader;T.onload=async N=>{var B;try{const ee=JSON.parse((B=N.target)==null?void 0:B.result);if(!ee.configs)throw new Error("无效的配置文件格式");if(!confirm("确定要导入配置吗？这将覆盖当前配置。"))return;m.value=!0;const le=[];if(C.value.forEach(Me=>{Me.subGroups.forEach(Ue=>{Ue.items.forEach(we=>{Object.prototype.hasOwnProperty.call(ee.configs,we.configKey)&&le.push({...we,configValue:ee.configs[we.configKey]})})})}),le.length===0){y("没有找到可导入的配置项");return}const Se=await he.batchUpdateConfigs(le);Se.success?(await L(),y(`成功导入 ${le.length} 项配置`)):y(Se.message||"导入失败","error")}catch(ee){console.error("导入配置失败:",ee),y(o("config.basicConfig.importFailed"),"error")}finally{m.value=!1,_.value=""}},T.readAsText(S)};return _e(()=>{L()}),(d,_)=>(i(),r("div",Ge,[e("div",Ke,[e("div",Je,[e("h2",null,s(n(o)("config.basicConfig.title")),1),e("div",ze,[e("span",He,[_[1]||(_[1]=e("span",{class:"stat-label"},"总配置项:",-1)),e("span",Xe,s(A.value.total),1)]),A.value.modified>0?(i(),r("span",Ye,[_[2]||(_[2]=e("span",{class:"stat-label"},"已修改:",-1)),e("span",We,s(A.value.modified),1)])):V("",!0)])]),e("div",Qe,[e("div",Ze,[e("button",{onClick:q,class:"action-btn",title:"导出配置"}," 📤 "),e("label",eo,[_[3]||(_[3]=k(" 📥 ")),e("input",{type:"file",accept:".json",onChange:w,style:{display:"none"}},null,32)])]),e("div",oo,[O(e("input",{"onUpdate:modelValue":_[0]||(_[0]=S=>E.value=S),type:"text",placeholder:d.$t("config.search"),class:"search-input"},null,8,to),[[K,E.value]]),_[4]||(_[4]=e("span",{class:"search-icon"},"🔍",-1))])])]),t.value?(i(),r("div",so,[_[5]||(_[5]=e("div",{class:"loading-spinner"},null,-1)),e("p",null,s(d.$t("config.loading")),1)])):f.value.length>0?(i(),r("div",no,[(i(!0),r(X,null,Y(f.value,S=>(i(),r("div",{key:S.name,class:"config-group"},[e("div",ao,[e("div",lo,[e("span",io,s(M[S.name]||"⚙️"),1)]),e("div",co,[e("button",{onClick:T=>H(S.name),class:"reset-btn",disabled:m.value,title:d.$t("config.resetGroupConfirm")},s(d.$t("config.reset")),9,ro)]),_[6]||(_[6]=e("div",{class:"group-divider"},null,-1))]),e("div",uo,[(i(!0),r(X,null,Y(S.subGroups,T=>(i(),r("div",{key:T.name,class:"sub-group"},[e("div",{class:"sub-group-header",onClick:p=>be(S.name,T.name)},[e("div",go,[_[7]||(_[7]=e("span",{class:"sub-group-icon"},"📁",-1)),e("h4",fo,s(T.displayName),1),e("span",mo,"("+s(T.items.length)+")",1)]),e("span",{class:oe(["collapse-icon",{collapsed:ge(S.name,T.name)}])}," ▼ ",2)],8,po),O(e("div",vo,[(i(!0),r(X,null,Y(T.items,p=>(i(),r("div",{key:p.id,class:oe(["config-item",{modified:g.value.get(p.id)!==p.configValue}])},[p.inputType==="BOOLEAN"||p.inputType==="CHECKBOX"?(i(),r("div",ho,[e("div",yo,[e("div",_o,[e("label",bo,[k(s(p.description||p.displayName)+" ",1),e("span",Co,s(p.inputType==="CHECKBOX"?d.$t("config.types.checkbox"):d.$t("config.types.boolean")),1),g.value.get(p.id)!==p.configValue?(i(),r("span",$o,s(d.$t("config.modified")),1)):V("",!0)]),e("span",{class:"config-key",title:p.configKey},s(p.configKey),9,wo)])]),e("div",ko,[p.options&&p.options.length>0?(i(),r("select",{key:0,class:"config-input select-input",value:p.configValue,onChange:N=>{var B;return c(p,((B=N.target)==null?void 0:B.value)||"")}},[(i(!0),r(X,null,Y(p.options,N=>(i(),r("option",{key:Z(N),value:Z(N)},s(G(N)),9,To))),128))],40,So)):(i(),ie(je,{key:1,enabled:te(p.configValue),label:"","onUpdate:switchValue":N=>c(p,N)},null,8,["enabled","onUpdate:switchValue"]))])])):p.inputType==="SELECT"?(i(),r("div",Ao,[e("div",xo,[e("div",Eo,[e("label",Mo,[k(s(p.description||p.displayName)+" ",1),e("span",Uo,s(d.$t("config.types.select")),1),g.value.get(p.id)!==p.configValue?(i(),r("span",Vo,s(d.$t("config.modified")),1)):V("",!0)]),e("span",{class:"config-key",title:p.configKey},s(p.configKey),9,No)])]),e("div",Po,[e("select",{class:"config-input select-input",value:p.configValue,onChange:N=>{var B;return c(p,((B=N.target)==null?void 0:B.value)||"")}},[(i(!0),r(X,null,Y(p.options||[],N=>(i(),r("option",{key:Z(N),value:Z(N)},s(G(N)),9,Fo))),128))],40,Bo)])])):p.inputType==="TEXTAREA"?(i(),r("div",Ro,[e("div",Do,[e("div",Lo,[e("label",Io,[k(s(p.description||p.displayName)+" ",1),e("span",Oo,s(d.$t("config.types.textarea")),1),g.value.get(p.id)!==p.configValue?(i(),r("span",qo,s(d.$t("config.modified")),1)):V("",!0)]),e("span",{class:"config-key",title:p.configKey},s(p.configKey),9,jo)])]),e("div",Go,[e("textarea",{class:"config-input textarea-input",value:p.configValue,onInput:N=>{var B;return c(p,((B=N.target)==null?void 0:B.value)||"")},onBlur:l,rows:"3"},null,40,Ko)])])):p.inputType==="NUMBER"?(i(),r("div",Jo,[e("div",zo,[e("div",Ho,[e("label",Xo,[k(s(p.description||p.displayName)+" ",1),e("span",Yo,s(d.$t("config.types.number")),1),g.value.get(p.id)!==p.configValue?(i(),r("span",Wo,s(d.$t("config.modified")),1)):V("",!0)]),e("span",{class:"config-key",title:p.configKey},s(p.configKey),9,Qo),p.min||p.max?(i(),r("div",Zo,[e("span",et,s(d.$t("config.range"))+": "+s(p.min||0)+" - "+s(p.max||"∞"),1)])):V("",!0)])]),e("div",ot,[e("input",{type:"number",class:"config-input number-input",value:R(p.configValue),onInput:N=>{var B;return c(p,((B=N.target)==null?void 0:B.value)||"")},onBlur:l,min:p.min||1,max:p.max||1e4},null,40,tt)])])):(i(),r("div",st,[e("div",nt,[e("div",at,[e("label",lt,[k(s(p.description||p.displayName)+" ",1),e("span",it,s(p.inputType==="TEXT"?d.$t("config.types.text"):d.$t("config.types.string")),1),g.value.get(p.id)!==p.configValue?(i(),r("span",ct,s(d.$t("config.modified")),1)):V("",!0)]),e("span",{class:"config-key",title:p.configKey},s(p.configKey),9,rt)])]),e("div",dt,[e("input",{type:"text",class:"config-input text-input",value:p.configValue,onInput:N=>{var B;return c(p,((B=N.target)==null?void 0:B.value)||"")},onBlur:l},null,40,ut)])]))],2))),128))],512),[[Ee,!ge(S.name,T.name)]])]))),128))])]))),128))])):(i(),r("div",pt,[e("p",null,s(d.$t("config.notFound")),1)])),b($e,{name:"message-fade"},{default:Q(()=>[h.show?(i(),r("div",{key:0,class:oe(["message-toast",h.type])},s(h.text),3)):V("",!0)]),_:1})]))}}),ft=ce(gt,[["__scopeId","data-v-99a0498e"]]),mt={class:"modal-header"},vt={class:"modal-content"},ht={class:"modal-footer"},yt=re({__name:"index",props:{modelValue:{type:Boolean,required:!0},title:{type:String,default:""}},emits:["update:modelValue","confirm"],setup(j){const o=t=>{t.target===t.currentTarget&&(t.stopPropagation(),t.preventDefault())};return(t,m)=>(i(),ie(Pe,{to:"body"},[b($e,{name:"modal"},{default:Q(()=>[j.modelValue?(i(),r("div",{key:0,class:"modal-overlay",onClick:o},[e("div",{class:"modal-container",onClick:m[3]||(m[3]=ye(()=>{},["stop"]))},[e("div",mt,[e("h3",null,s(j.title),1),e("button",{class:"close-btn",onClick:m[0]||(m[0]=C=>t.$emit("update:modelValue",!1))},[b(n(x),{icon:"carbon:close"})])]),e("div",vt,[Te(t.$slots,"default",{},void 0,!0)]),e("div",ht,[Te(t.$slots,"footer",{},()=>[e("button",{class:"cancel-btn",onClick:m[1]||(m[1]=C=>t.$emit("update:modelValue",!1))},s(t.$t("common.cancel")),1),e("button",{class:"confirm-btn",onClick:m[2]||(m[2]=C=>t.$emit("confirm"))},s(t.$t("common.confirm")),1)],!0)])])])):V("",!0)]),_:3})]))}}),pe=ce(yt,[["__scopeId","data-v-baaf1c89"]]),_t={class:"tool-selection-content"},bt={class:"tool-controls"},Ct={class:"search-container"},$t={class:"sort-container"},wt={class:"tool-summary"},kt={class:"summary-text"},St={key:0,class:"tool-groups"},Tt=["onClick"],At={class:"group-title-area"},xt={class:"group-name"},Et={class:"group-count"},Mt={class:"group-enable-all"},Ut=["checked","onChange","data-group"],Vt={class:"tool-info"},Nt={class:"tool-selection-name"},Pt={key:0,class:"tool-selection-desc"},Bt={class:"tool-actions"},Ft=["checked","onChange"],Rt={key:1,class:"empty-state"},Dt=re({__name:"index",props:{modelValue:{type:Boolean},tools:{},selectedToolIds:{}},emits:["update:modelValue","confirm"],setup(j,{emit:o}){const t=j,m=o,C=ae({get:()=>t.modelValue,set:a=>m("update:modelValue",a)}),g=P(""),u=P("group"),h=P(new Set),E=P([]),U=(a,l)=>{const y=document.querySelector(`input[data-group="${a}"]`);y&&(y.indeterminate=I(l))};ke(()=>t.selectedToolIds,a=>{E.value=[...a]},{immediate:!0});const $=ae(()=>{let a=t.tools.filter(l=>l.key);if(g.value){const l=g.value.toLowerCase();a=a.filter(y=>{var L;return y.name.toLowerCase().includes(l)||y.description.toLowerCase().includes(l)||(((L=y.serviceGroup)==null?void 0:L.toLowerCase().includes(l))??!1)})}switch(u.value){case"name":a=[...a].sort((l,y)=>l.name.localeCompare(y.name));break;case"enabled":a=[...a].sort((l,y)=>{const L=E.value.includes(l.key),D=E.value.includes(y.key);return L&&!D?-1:!L&&D?1:l.name.localeCompare(y.name)});break;case"group":default:a=[...a].sort((l,y)=>{const L=l.serviceGroup??"未分组",D=y.serviceGroup??"未分组";return L!==D?L.localeCompare(D):l.name.localeCompare(y.name)});break}return a}),M=ae(()=>{const a=new Map;return $.value.forEach(l=>{const y=l.serviceGroup??"未分组";a.has(y)||a.set(y,[]),a.get(y).push(l)}),new Map([...a.entries()].sort())}),J=ae(()=>$.value.length);ke([E,M],()=>{Fe(()=>{for(const[a,l]of M.value)U(a,l)})},{flush:"post",deep:!1});const W=a=>E.value.includes(a),te=(a,l)=>{l.stopPropagation();const L=l.target.checked;if(!a){console.error("toolKey is undefined, cannot proceed");return}L?E.value.includes(a)||(E.value=[...E.value,a]):E.value=E.value.filter(D=>D!==a)},R=a=>a.filter(l=>E.value.includes(l.key)),v=a=>a.length>0&&a.every(l=>E.value.includes(l.key)),I=a=>{const l=R(a).length;return l>0&&l<a.length},Z=(a,l)=>{l.stopPropagation();const L=l.target.checked,D=a.map(H=>H.key);if(L){const H=[...E.value];D.forEach(se=>{H.includes(se)||H.push(se)}),E.value=H}else E.value=E.value.filter(H=>!D.includes(H))},G=a=>{h.value.has(a)?h.value.delete(a):h.value.add(a)},F=()=>{m("confirm",[...E.value]),m("update:modelValue",!1)},c=()=>{E.value=[...t.selectedToolIds],m("update:modelValue",!1)};return ke(C,a=>{if(a){h.value.clear();const l=Array.from(M.value.keys());l.length>1&&l.slice(1).forEach(y=>{h.value.add(y)})}}),(a,l)=>(i(),ie(pe,{modelValue:C.value,"onUpdate:modelValue":[l[4]||(l[4]=y=>C.value=y),c],title:"选择工具",onConfirm:F},{default:Q(()=>[e("div",_t,[e("div",bt,[e("div",Ct,[O(e("input",{"onUpdate:modelValue":l[0]||(l[0]=y=>g.value=y),type:"text",class:"search-input",placeholder:"搜索工具..."},null,512),[[K,g.value]])]),e("div",$t,[O(e("select",{"onUpdate:modelValue":l[1]||(l[1]=y=>u.value=y),class:"sort-select"},l[5]||(l[5]=[e("option",{value:"group"},"按服务组排序",-1),e("option",{value:"name"},"按名称排序",-1),e("option",{value:"enabled"},"按启用状态排序",-1)]),512),[[Be,u.value]])])]),e("div",wt,[e("span",kt," 共 "+s(M.value.size)+" 个服务组，"+s(J.value)+" 个工具 (已选择 "+s(E.value.length)+" 个) ",1)]),M.value.size>0?(i(),r("div",St,[(i(!0),r(X,null,Y(M.value,([y,L])=>(i(),r("div",{key:y,class:"tool-group"},[e("div",{class:oe(["tool-group-header",{collapsed:h.value.has(y)}]),onClick:D=>G(y)},[e("div",At,[b(n(x),{icon:h.value.has(y)?"carbon:chevron-right":"carbon:chevron-down",class:"collapse-icon"},null,8,["icon"]),b(n(x),{icon:"carbon:folder",class:"group-icon"}),e("span",xt,s(y),1),e("span",Et," ("+s(R(L).length)+"/"+s(L.length)+") ",1)]),e("div",{class:"group-actions",onClick:l[2]||(l[2]=ye(()=>{},["stop"]))},[e("label",Mt,[e("input",{type:"checkbox",class:"group-enable-checkbox",checked:v(L),onChange:D=>Z(L,D),"data-group":y},null,40,Ut),l[6]||(l[6]=e("span",{class:"enable-label"},"启用全部",-1))])])],10,Tt),e("div",{class:oe(["tool-group-content",{collapsed:h.value.has(y)}])},[(i(!0),r(X,null,Y(L.filter(D=>D&&D.key),D=>(i(),r("div",{key:D.key,class:"tool-selection-item"},[e("div",Vt,[e("div",Nt,s(D.name),1),D.description?(i(),r("div",Pt,s(D.description),1)):V("",!0)]),e("div",Bt,[e("label",{class:"tool-enable-switch",onClick:l[3]||(l[3]=ye(()=>{},["stop"]))},[e("input",{type:"checkbox",class:"tool-enable-checkbox",checked:W(D.key),onChange:H=>te(D.key,H)},null,40,Ft),l[7]||(l[7]=e("span",{class:"tool-enable-slider"},null,-1))])])]))),128))],2)]))),128))])):(i(),r("div",Rt,[b(n(x),{icon:"carbon:tools",class:"empty-icon"}),l[8]||(l[8]=e("p",null,"没有找到工具",-1))]))])]),_:1},8,["modelValue"]))}}),Lt=ce(Dt,[["__scopeId","data-v-c30d6872"]]);class ue{static async handleResponse(o){if(!o.ok)try{const t=await o.json();throw new Error(t.message||`API request failed: ${o.status}`)}catch{throw new Error(`API request failed: ${o.status} ${o.statusText}`)}return o}static async getAllAgents(){try{const o=await fetch(this.BASE_URL);return await(await this.handleResponse(o)).json()}catch(o){throw console.error("Failed to get Agent list:",o),o}}static async getAgentById(o){try{const t=await fetch(`${this.BASE_URL}/${o}`);return await(await this.handleResponse(t)).json()}catch(t){throw console.error(`Failed to get Agent[${o}] details:`,t),t}}static async createAgent(o){try{const t=await fetch(this.BASE_URL,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});return await(await this.handleResponse(t)).json()}catch(t){throw console.error("Failed to create Agent:",t),t}}static async updateAgent(o,t){try{const m=await fetch(`${this.BASE_URL}/${o}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});return await(await this.handleResponse(m)).json()}catch(m){throw console.error(`Failed to update Agent[${o}]:`,m),m}}static async deleteAgent(o){try{const t=await fetch(`${this.BASE_URL}/${o}`,{method:"DELETE"});if(t.status===400)throw new Error("Cannot delete default Agent");await this.handleResponse(t)}catch(t){throw console.error(`Failed to delete Agent[${o}]:`,t),t}}static async getAvailableTools(){try{const o=await fetch(`${this.BASE_URL}/tools`);return await(await this.handleResponse(o)).json()}catch(o){throw console.error("Failed to get available tools list:",o),o}}}fe(ue,"BASE_URL","/api/agents");class de{static async handleResponse(o){if(!o.ok)try{const t=await o.json();throw new Error(t.message||`API request failed: ${o.status}`)}catch{throw new Error(`API request failed: ${o.status} ${o.statusText}`)}return o}static async getAllModels(){try{const o=await fetch(this.BASE_URL);return await(await this.handleResponse(o)).json()}catch(o){throw console.error("Failed to get Model list:",o),o}}static async getAllTypes(){try{const o=await fetch(`${this.BASE_URL}/types`);return await(await this.handleResponse(o)).json()}catch(o){throw console.error("Failed to get Model list:",o),o}}static async getModelById(o){try{const t=await fetch(`${this.BASE_URL}/${o}`);return await(await this.handleResponse(t)).json()}catch(t){throw console.error(`Failed to get Model[${o}] details:`,t),t}}static async createModel(o){try{const t=await fetch(this.BASE_URL,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});return await(await this.handleResponse(t)).json()}catch(t){throw console.error("Failed to create Model:",t),t}}static async updateModel(o,t){try{const m=await fetch(`${this.BASE_URL}/${o}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});return await(await this.handleResponse(m)).json()}catch(m){throw console.error(`Failed to update Model[${o}]:`,m),m}}static async deleteModel(o){try{const t=await fetch(`${this.BASE_URL}/${o}`,{method:"DELETE"});if(t.status===400)throw new Error("Cannot delete default Model");await this.handleResponse(t)}catch(t){throw console.error(`Failed to delete Model[${o}]:`,t),t}}}fe(de,"BASE_URL","/api/models");const It={class:"config-panel"},Ot={class:"panel-header"},qt={class:"panel-actions"},jt=["disabled"],Gt={class:"agent-layout"},Kt={class:"agent-list"},Jt={class:"list-header"},zt={class:"agent-count"},Ht={key:0,class:"agents-container"},Xt=["onClick"],Yt={class:"agent-card-header"},Wt={class:"agent-name"},Qt={class:"agent-desc"},Zt={key:0,class:"agent-model"},es={class:"model-tag"},os={class:"model-tag"},ts={key:1,class:"agent-tools"},ss={key:0,class:"tool-more"},ns={key:1,class:"loading-state"},as={key:2,class:"empty-state"},ls={key:0,class:"agent-detail"},is={class:"detail-header"},cs={class:"detail-actions"},rs={class:"form-item"},ds=["placeholder"],us={class:"form-item"},ps=["placeholder"],gs={class:"form-item"},fs=["value","placeholder"],ms={class:"model-section"},vs={class:"form-item"},hs={class:"model-chooser"},ys=["title"],_s={key:0,class:"current-model"},bs={class:"model-type"},Cs={class:"model-name"},$s={key:1,class:"current-model"},ws={class:"current-model"},ks={class:"dropdown-header"},Ss={class:"model-options"},Ts=["onClick"],As={class:"model-type"},xs={class:"model-name"},Es={class:"tools-section"},Ms={class:"assigned-tools"},Us={class:"section-header"},Vs={class:"tools-grid"},Ns={class:"tool-info"},Ps={class:"tool-name"},Bs={class:"tool-desc"},Fs={key:0,class:"no-tools"},Rs={key:1,class:"no-selection"},Ds={class:"modal-form"},Ls={class:"form-item"},Is=["placeholder"],Os={class:"form-item"},qs=["placeholder"],js={class:"form-item"},Gs=["value","placeholder"],Ks={class:"delete-confirm"},Js={class:"warning-text"},zs=re({__name:"agentConfig",setup(j){const{t:o}=ve(),t=P(!1),m=P(""),C=P(""),g=ne([]),u=P(null),h=ne([]),E=P(!1),U=P(!1),$=P(!1),M=P(!1),J=P(null),W=ne([]),te=()=>{M.value=!M.value},R=A=>{J.value=A,M.value=!1},v=ne({name:"",description:"",nextStepPrompt:""}),I=A=>{const f=h.find(q=>q.key===A);return f?f.name:A},Z=A=>{const f=h.find(q=>q.key===A);return f?f.description:""},G=(A,f)=>{f==="success"?(C.value=A,setTimeout(()=>{C.value=""},3e3)):(m.value=A,setTimeout(()=>{m.value=""},5e3))},F=async()=>{t.value=!0;try{const[A,f,q]=await Promise.all([ue.getAllAgents(),ue.getAvailableTools(),de.getAllModels()]),w=A.map(d=>({...d,availableTools:d.availableTools,...q}));g.splice(0,g.length,...w),h.splice(0,h.length,...f),W.splice(0,W.length,...q),w.length>0&&await c(w[0])}catch(A){console.error("加载数据失败:",A),G(o("config.agentConfig.loadDataFailed")+": "+A.message,"error");const f=[{key:"search-web",name:"网络搜索",description:"在互联网上搜索信息",enabled:!0,serviceGroup:"搜索服务"},{key:"search-local",name:"本地搜索",description:"在本地文件中搜索内容",enabled:!0,serviceGroup:"搜索服务"},{key:"file-read",name:"读取文件",description:"读取本地或远程文件内容",enabled:!0,serviceGroup:"文件服务"},{key:"file-write",name:"写入文件",description:"创建或修改文件内容",enabled:!0,serviceGroup:"文件服务"},{key:"file-delete",name:"删除文件",description:"删除指定的文件",enabled:!1,serviceGroup:"文件服务"},{key:"calculator",name:"计算器",description:"执行数学计算",enabled:!0,serviceGroup:"计算服务"},{key:"code-execute",name:"代码执行",description:"执行Python或JavaScript代码",enabled:!0,serviceGroup:"计算服务"},{key:"weather",name:"天气查询",description:"获取指定地区的天气信息",enabled:!0,serviceGroup:"信息服务"},{key:"currency",name:"汇率查询",description:"查询货币汇率信息",enabled:!0,serviceGroup:"信息服务"},{key:"email",name:"发送邮件",description:"发送电子邮件",enabled:!1,serviceGroup:"通信服务"},{key:"sms",name:"发送短信",description:"发送短信消息",enabled:!1,serviceGroup:"通信服务"}],q=[{id:"demo-1",name:"通用助手",description:"一个能够处理各种任务的智能助手",nextStepPrompt:"You are a helpful assistant that can answer questions and help with various tasks. What would you like me to help you with next?",availableTools:["search-web","calculator","weather"]},{id:"demo-2",name:"数据分析师",description:"专门用于数据分析和可视化的Agent",nextStepPrompt:"You are a data analyst assistant specialized in analyzing data and creating visualizations. Please provide the data you would like me to analyze.",availableTools:["file-read","file-write","calculator","code-execute"]}];h.splice(0,h.length,...f),g.splice(0,g.length,...q),q.length>0&&(u.value=q[0])}finally{t.value=!1}},c=async A=>{try{const f=await ue.getAgentById(A.id);u.value={...f,availableTools:f.availableTools},J.value=f.model??null}catch(f){console.error("加载Agent详情失败:",f),G(o("config.agentConfig.loadDetailsFailed")+": "+f.message,"error"),u.value={...A,availableTools:A.availableTools}}},a=()=>{v.name="",v.description="",v.nextStepPrompt="",E.value=!0},l=async()=>{var A;if(!v.name.trim()||!v.description.trim()){G(o("config.agentConfig.requiredFields"),"error");return}try{const f={name:v.name.trim(),description:v.description.trim(),nextStepPrompt:((A=v.nextStepPrompt)==null?void 0:A.trim())??"",availableTools:[]},q=await ue.createAgent(f);g.push(q),u.value=q,E.value=!1,G(o("config.agentConfig.createSuccess"),"success")}catch(f){G(o("config.agentConfig.createFailed")+": "+f.message,"error")}},y=()=>{$.value=!0},L=A=>{u.value&&(u.value.availableTools=[...A])},D=async()=>{if(u.value){if(!u.value.name.trim()||!u.value.description.trim()){G(o("config.agentConfig.requiredFields"),"error");return}try{u.value.model=J.value;const A=await ue.updateAgent(u.value.id,u.value),f=g.findIndex(q=>q.id===A.id);f!==-1&&(g[f]=A),u.value=A,u.value.model=J.value,G(o("config.agentConfig.saveSuccess"),"success")}catch(A){G(o("config.agentConfig.saveFailed")+": "+A.message,"error")}}},H=()=>{U.value=!0},se=async()=>{if(u.value)try{await ue.deleteAgent(u.value.id);const A=g.findIndex(f=>f.id===u.value.id);A!==-1&&g.splice(A,1),u.value=g.length>0?g[0]:null,U.value=!1,G(o("config.agentConfig.deleteSuccess"),"success")}catch(A){G(o("config.agentConfig.deleteFailed")+": "+A.message,"error")}},be=()=>{const A=document.createElement("input");A.type="file",A.accept=".json",A.onchange=f=>{var w;const q=(w=f.target.files)==null?void 0:w[0];if(q){const d=new FileReader;d.onload=async _=>{var S;try{const T=JSON.parse((S=_.target)==null?void 0:S.result);if(!T.name||!T.description)throw new Error(o("config.agentConfig.invalidFormat"));const{id:p,...N}=T,B=await ue.createAgent(N);g.push(B),u.value=B,G(o("config.agentConfig.importSuccess"),"success")}catch(T){G(o("config.agentConfig.importFailed")+": "+T.message,"error")}},d.readAsText(q)}},A.click()},ge=()=>{if(u.value)try{const A=JSON.stringify(u.value,null,2),f=new Blob([A],{type:"application/json"}),q=URL.createObjectURL(f),w=document.createElement("a");w.href=q,w.download=`agent-${u.value.name}-${new Date().toISOString().split("T")[0]}.json`,w.click(),URL.revokeObjectURL(q),G(o("config.agentConfig.exportSuccess"),"success")}catch(A){G(o("config.agentConfig.exportFailed")+": "+A.message,"error")}};return _e(()=>{F()}),(A,f)=>{var q;return i(),r("div",It,[e("div",Ot,[e("h2",null,s(n(o)("config.agentConfig.title")),1),e("div",qt,[e("button",{class:"action-btn",onClick:be},[b(n(x),{icon:"carbon:upload"}),k(" "+s(n(o)("config.agentConfig.import")),1)]),e("button",{class:"action-btn",onClick:ge,disabled:!u.value},[b(n(x),{icon:"carbon:download"}),k(" "+s(n(o)("config.agentConfig.export")),1)],8,jt)])]),e("div",Gt,[e("div",Kt,[e("div",Jt,[e("h3",null,s(n(o)("config.agentConfig.configuredAgents")),1),e("span",zt,"("+s(g.length)+s(n(o)("config.agentConfig.agentCount"))+")",1)]),t.value?V("",!0):(i(),r("div",Ht,[(i(!0),r(X,null,Y(g,w=>{var d,_;return i(),r("div",{key:w.id,class:oe(["agent-card",{active:((d=u.value)==null?void 0:d.id)===w.id}]),onClick:S=>c(w)},[e("div",Yt,[e("span",Wt,s(w.name),1),b(n(x),{icon:"carbon:chevron-right"})]),e("p",Qt,s(w.description),1),w.model?(i(),r("div",Zt,[e("span",es,s(w.model.type),1),e("span",os,s(w.model.modelName),1)])):V("",!0),((_=w.availableTools)==null?void 0:_.length)>0?(i(),r("div",ts,[(i(!0),r(X,null,Y(w.availableTools.slice(0,3),S=>(i(),r("span",{key:S,class:"tool-tag"},s(I(S)),1))),128)),w.availableTools.length>3?(i(),r("span",ss," +"+s(w.availableTools.length-3),1)):V("",!0)])):V("",!0)],10,Xt)}),128))])),t.value?(i(),r("div",ns,[b(n(x),{icon:"carbon:loading",class:"loading-icon"}),k(" "+s(n(o)("common.loading")),1)])):V("",!0),!t.value&&g.length===0?(i(),r("div",as,[b(n(x),{icon:"carbon:bot",class:"empty-icon"}),e("p",null,s(n(o)("config.agentConfig.noAgent")),1)])):V("",!0),e("button",{class:"add-btn",onClick:a},[b(n(x),{icon:"carbon:add"}),k(" "+s(n(o)("config.agentConfig.createNew")),1)])]),u.value?(i(),r("div",ls,[e("div",is,[e("h3",null,s(u.value.name),1),e("div",cs,[e("button",{class:"action-btn primary",onClick:D},[b(n(x),{icon:"carbon:save"}),k(" "+s(n(o)("common.save")),1)]),e("button",{class:"action-btn danger",onClick:H},[b(n(x),{icon:"carbon:trash-can"}),k(" "+s(n(o)("common.delete")),1)])])]),e("div",rs,[e("label",null,[k(s(n(o)("config.agentConfig.agentName"))+" ",1),f[15]||(f[15]=e("span",{class:"required"},"*",-1))]),O(e("input",{type:"text","onUpdate:modelValue":f[0]||(f[0]=w=>u.value.name=w),placeholder:n(o)("config.agentConfig.agentNamePlaceholder"),required:""},null,8,ds),[[K,u.value.name]])]),e("div",us,[e("label",null,[k(s(n(o)("config.agentConfig.description"))+" ",1),f[16]||(f[16]=e("span",{class:"required"},"*",-1))]),O(e("textarea",{"onUpdate:modelValue":f[1]||(f[1]=w=>u.value.description=w),rows:"3",placeholder:n(o)("config.agentConfig.descriptionPlaceholder"),required:""},null,8,ps),[[K,u.value.description]])]),e("div",gs,[e("label",null,s(n(o)("config.agentConfig.nextStepPrompt")),1),e("textarea",{value:u.value.nextStepPrompt||"",onInput:f[2]||(f[2]=w=>u.value.nextStepPrompt=w.target.value),rows:"8",placeholder:n(o)("config.agentConfig.nextStepPromptPlaceholder")},null,40,fs)]),e("div",ms,[e("h4",null,s(n(o)("config.agentConfig.modelConfiguration")),1),e("div",vs,[e("div",hs,[e("button",{class:"model-btn",onClick:te,title:A.$t("model.switch")},[b(n(x),{icon:"carbon:build-run",width:"18"}),J.value?(i(),r("span",_s,[e("span",bs,s(J.value.type),1),f[17]||(f[17]=e("span",{class:"spacer"},null,-1)),e("span",Cs,s(J.value.modelName),1)])):(i(),r("span",$s,[e("span",ws,s(n(o)("config.agentConfig.modelConfigurationLabel")),1)])),b(n(x),{icon:M.value?"carbon:chevron-up":"carbon:chevron-down",width:"14",class:"chevron"},null,8,["icon"])],8,ys),M.value?(i(),r("div",{key:0,class:"model-dropdown",onClick:f[4]||(f[4]=ye(()=>{},["stop"]))},[e("div",ks,[e("span",null,s(n(o)("config.agentConfig.modelConfigurationLabel")),1),e("button",{class:"close-btn",onClick:f[3]||(f[3]=w=>M.value=!1)},[b(n(x),{icon:"carbon:close",width:"16"})])]),e("div",Ss,[(i(!0),r(X,null,Y(W,w=>{var d,_;return i(),r("button",{key:w.id,class:oe(["model-option",{active:((d=J.value)==null?void 0:d.id)===w.id}]),onClick:S=>R(w)},[e("span",As,s(w.type),1),e("span",xs,s(w.modelName),1),((_=J.value)==null?void 0:_.id)===w.id?(i(),ie(n(x),{key:0,icon:"carbon:checkmark",width:"16",class:"check-icon"})):V("",!0)],10,Ts)}),128))])])):V("",!0),M.value?(i(),r("div",{key:1,class:"backdrop",onClick:f[5]||(f[5]=w=>M.value=!1)})):V("",!0)])])]),e("div",Es,[e("h4",null,s(n(o)("config.agentConfig.toolConfiguration")),1),e("div",Ms,[e("div",Us,[e("span",null,s(n(o)("config.agentConfig.assignedTools"))+" ("+s((u.value.availableTools||[]).length)+")",1),h.length>0?(i(),r("button",{key:0,class:"action-btn small",onClick:y},[b(n(x),{icon:"carbon:add"}),k(" "+s(n(o)("config.agentConfig.addRemoveTools")),1)])):V("",!0)]),e("div",Vs,[(i(!0),r(X,null,Y(u.value.availableTools||[],w=>(i(),r("div",{key:w,class:"tool-item assigned"},[e("div",Ns,[e("span",Ps,s(I(w)),1),e("span",Bs,s(Z(w)),1)])]))),128)),u.value.availableTools.length===0?(i(),r("div",Fs,[b(n(x),{icon:"carbon:tool-box"}),e("span",null,s(n(o)("config.agentConfig.noAssignedTools")),1)])):V("",!0)])])])])):(i(),r("div",Rs,[b(n(x),{icon:"carbon:bot",class:"placeholder-icon"}),e("p",null,s(n(o)("config.agentConfig.selectAgentHint")),1)]))]),b(pe,{modelValue:E.value,"onUpdate:modelValue":f[9]||(f[9]=w=>E.value=w),title:n(o)("config.agentConfig.newAgent"),onConfirm:l},{default:Q(()=>[e("div",Ds,[e("div",Ls,[e("label",null,[k(s(n(o)("config.agentConfig.agentName"))+" ",1),f[18]||(f[18]=e("span",{class:"required"},"*",-1))]),O(e("input",{type:"text","onUpdate:modelValue":f[6]||(f[6]=w=>v.name=w),placeholder:n(o)("config.agentConfig.agentNamePlaceholder"),required:""},null,8,Is),[[K,v.name]])]),e("div",Os,[e("label",null,[k(s(n(o)("config.agentConfig.description"))+" ",1),f[19]||(f[19]=e("span",{class:"required"},"*",-1))]),O(e("textarea",{"onUpdate:modelValue":f[7]||(f[7]=w=>v.description=w),rows:"3",placeholder:n(o)("config.agentConfig.descriptionPlaceholder"),required:""},null,8,qs),[[K,v.description]])]),e("div",js,[e("label",null,s(n(o)("config.agentConfig.nextStepPrompt")),1),e("textarea",{value:v.nextStepPrompt||"",onInput:f[8]||(f[8]=w=>v.nextStepPrompt=w.target.value),rows:"8",placeholder:n(o)("config.agentConfig.nextStepPromptPlaceholder")},null,40,Gs)])])]),_:1},8,["modelValue","title"]),b(Lt,{modelValue:$.value,"onUpdate:modelValue":f[10]||(f[10]=w=>$.value=w),tools:h,"selected-tool-ids":((q=u.value)==null?void 0:q.availableTools)||[],onConfirm:L},null,8,["modelValue","tools","selected-tool-ids"]),b(pe,{modelValue:U.value,"onUpdate:modelValue":f[12]||(f[12]=w=>U.value=w),title:n(o)("config.agentConfig.deleteConfirm")},{footer:Q(()=>[e("button",{class:"cancel-btn",onClick:f[11]||(f[11]=w=>U.value=!1)},s(n(o)("common.cancel")),1),e("button",{class:"confirm-btn danger",onClick:se},s(n(o)("common.delete")),1)]),default:Q(()=>{var w;return[e("div",Ks,[b(n(x),{icon:"carbon:warning",class:"warning-icon"}),e("p",null,[k(s(n(o)("config.agentConfig.deleteConfirmText"))+" ",1),e("strong",null,s((w=u.value)==null?void 0:w.name),1),k(" "+s(n(o)("common.confirm"))+"？",1)]),e("p",Js,s(n(o)("config.agentConfig.deleteWarning")),1)])]}),_:1},8,["modelValue","title"]),m.value?(i(),r("div",{key:0,class:"error-toast",onClick:f[13]||(f[13]=w=>m.value="")},[b(n(x),{icon:"carbon:error"}),k(" "+s(m.value),1)])):V("",!0),C.value?(i(),r("div",{key:1,class:"success-toast",onClick:f[14]||(f[14]=w=>C.value="")},[b(n(x),{icon:"carbon:checkmark"}),k(" "+s(C.value),1)])):V("",!0)])}}}),Hs=ce(zs,[["__scopeId","data-v-86b6e145"]]),Xs={class:"custom-select"},Ys=["title"],Ws={key:0,class:"current-option"},Qs={class:"option-name"},Zs={key:1,class:"current-option"},en={class:"dropdown-header"},on={class:"select-options"},tn=["onClick"],sn={class:"option-name"},nn=re({__name:"index",props:{modelValue:{},options:{},placeholder:{},dropdownTitle:{},icon:{}},emits:["update:modelValue"],setup(j,{emit:o}){const t=j,m=o,C=P(!1),g=ae(()=>t.options.find(U=>U.id===t.modelValue)),u=U=>U.id===t.modelValue,h=()=>{C.value=!C.value},E=U=>{m("update:modelValue",U.id),C.value=!1};return(U,$)=>(i(),r("div",Xs,[e("button",{class:"select-btn",onClick:h,title:U.placeholder},[b(n(x),{icon:t.icon||"carbon:select-01",width:"18"},null,8,["icon"]),g.value?(i(),r("span",Ws,[e("span",Qs,s(g.value.name),1)])):(i(),r("span",Zs,s(U.placeholder),1)),b(n(x),{icon:C.value?"carbon:chevron-up":"carbon:chevron-down",width:"14",class:"chevron"},null,8,["icon"])],8,Ys),b($e,{name:"slideDown"},{default:Q(()=>[O(e("div",{class:"select-dropdown",onClick:$[1]||($[1]=ye(()=>{},["stop"]))},[e("div",en,[e("span",null,s(U.dropdownTitle),1),e("button",{class:"close-btn",onClick:$[0]||($[0]=M=>C.value=!1)},[b(n(x),{icon:"carbon:close",width:"16"})])]),e("div",on,[(i(!0),r(X,null,Y(U.options,M=>(i(),r("button",{key:M.id,class:oe(["select-option",{active:u(M)}]),onClick:J=>E(M)},[e("span",sn,s(M.name),1),u(M)?(i(),ie(n(x),{key:0,icon:"carbon:checkmark",width:"16",class:"check-icon"})):V("",!0)],10,tn))),128))])],512),[[Ee,C.value]])]),_:1}),C.value?(i(),r("div",{key:0,class:"backdrop",onClick:$[2]||($[2]=M=>C.value=!1)})):V("",!0)]))}}),xe=ce(nn,[["__scopeId","data-v-ed05fea8"]]),an={class:"config-panel"},ln={class:"panel-header"},cn={class:"panel-actions"},rn=["disabled"],dn={class:"model-layout"},un={class:"model-list"},pn={class:"list-header"},gn={class:"model-count"},fn={key:0,class:"models-container"},mn=["onClick"],vn={class:"model-card-header"},hn={class:"model-name"},yn={class:"model-desc"},_n={key:0,class:"model-type"},bn={class:"model-tag"},Cn={key:1,class:"loading-state"},$n={key:2,class:"empty-state"},wn={key:0,class:"model-detail"},kn={class:"detail-header"},Sn={class:"detail-actions"},Tn={class:"form-item"},An={class:"form-item"},xn=["placeholder"],En={class:"form-item"},Mn=["placeholder"],Un={class:"form-item"},Vn=["placeholder"],Nn={class:"form-item"},Pn=["placeholder"],Bn={key:1,class:"no-selection"},Fn={class:"modal-form"},Rn={class:"form-item"},Dn={class:"form-item"},Ln=["placeholder"],In={class:"form-item"},On=["placeholder"],qn={class:"form-item"},jn=["placeholder"],Gn={class:"form-item"},Kn=["placeholder"],Jn={class:"delete-confirm"},zn={class:"warning-text"},Hn=re({__name:"modelConfig",setup(j){const{t:o}=ve(),t=P(!1),m=P(""),C=P(""),g=ne([]),u=ne([]),h=P(null),E=P(!1),U=P(!1),$=ne({baseUrl:"",apiKey:"",modelName:"",modelDescription:"",type:""}),M=(c,a)=>{a==="success"?(C.value=c,setTimeout(()=>{C.value=""},3e3)):(m.value=c,setTimeout(()=>{m.value=""},5e3))},J=async()=>{t.value=!0;try{const[c,a]=await Promise.all([de.getAllModels(),de.getAllTypes()]),l=c.map(y=>({...y}));g.splice(0,g.length,...l),u.splice(0,g.length,...a),l.length>0&&await W(l[0])}catch(c){console.error("加载数据失败:",c),M(o("config.modelConfig.loadDataFailed")+": "+c.message,"error")}finally{t.value=!1}},W=async c=>{try{const a=await de.getModelById(c.id);h.value={...a}}catch(a){console.error("加载Model详情失败:",a),M(o("config.modelConfig.loadDetailsFailed")+": "+a.message,"error"),h.value={...c}}},te=()=>{$.baseUrl="",$.apiKey="",$.modelName="",$.modelDescription="",$.type="",E.value=!0},R=async()=>{if(!$.modelName.trim()||!$.modelDescription.trim()){M(o("config.modelConfig.requiredFields"),"error");return}try{const c={baseUrl:$.baseUrl.trim(),apiKey:$.apiKey.trim(),modelName:$.modelName.trim(),modelDescription:$.modelDescription.trim(),type:$.type.trim()},a=await de.createModel(c);g.push(a),h.value=a,E.value=!1,M(o("config.modelConfig.createSuccess"),"success")}catch(c){M(o("config.modelConfig.createFailed")+": "+c.message,"error")}},v=async()=>{if(h.value){if(!h.value.modelName.trim()||!h.value.modelDescription.trim()){M(o("config.modelConfig.requiredFields"),"error");return}try{const c=await de.updateModel(h.value.id,h.value),a=g.findIndex(l=>l.id===c.id);a!==-1&&(g[a]=c),h.value=c,M(o("config.modelConfig.saveSuccess"),"success")}catch(c){M(o("config.modelConfig.saveFailed")+": "+c.message,"error")}}},I=()=>{U.value=!0},Z=async()=>{if(h.value)try{await de.deleteModel(h.value.id);const c=g.findIndex(a=>a.id===h.value.id);c!==-1&&g.splice(c,1),h.value=g.length>0?g[0]:null,U.value=!1,M(o("config.modelConfig.deleteSuccess"),"success")}catch(c){M(o("config.modelConfig.deleteFailed")+": "+c.message,"error")}},G=()=>{const c=document.createElement("input");c.type="file",c.accept=".json",c.onchange=a=>{var y;const l=(y=a.target.files)==null?void 0:y[0];if(l){const L=new FileReader;L.onload=async D=>{var H;try{const se=JSON.parse((H=D.target)==null?void 0:H.result);if(!se.modelName||!se.modelDescription)throw new Error(o("config.modelConfig.invalidFormat"));const{id:be,...ge}=se,A=await de.createModel(ge);g.push(A),h.value=A,M(o("config.modelConfig.importSuccess"),"success")}catch(se){M(o("config.modelConfig.importFailed")+": "+se.message,"error")}},L.readAsText(l)}},c.click()},F=()=>{if(h.value)try{const c=JSON.stringify(h.value,null,2),a=new Blob([c],{type:"application/json"}),l=URL.createObjectURL(a),y=document.createElement("a");y.href=l,y.download=`model-${h.value.modelName}-${new Date().toISOString().split("T")[0]}.json`,y.click(),URL.revokeObjectURL(l),M(o("config.modelConfig.exportSuccess"),"success")}catch(c){M(o("config.modelConfig.exportFailed")+": "+c.message,"error")}};return _e(()=>{J()}),(c,a)=>(i(),r("div",an,[e("div",ln,[e("h2",null,s(n(o)("config.modelConfig.title")),1),e("div",cn,[e("button",{class:"action-btn",onClick:G},[b(n(x),{icon:"carbon:upload"}),k(" "+s(n(o)("config.modelConfig.import")),1)]),e("button",{class:"action-btn",onClick:F,disabled:!h.value},[b(n(x),{icon:"carbon:download"}),k(" "+s(n(o)("config.modelConfig.export")),1)],8,rn)])]),e("div",dn,[e("div",un,[e("div",pn,[e("h3",null,s(n(o)("config.modelConfig.configuredModels")),1),e("span",gn,"("+s(g.length)+")",1)]),t.value?V("",!0):(i(),r("div",fn,[(i(!0),r(X,null,Y(g,l=>{var y;return i(),r("div",{key:l.id,class:oe(["model-card",{active:((y=h.value)==null?void 0:y.id)===l.id}]),onClick:L=>W(l)},[e("div",vn,[e("span",hn,s(l.modelName),1),b(n(x),{icon:"carbon:chevron-right"})]),e("p",yn,s(l.modelDescription),1),l.type?(i(),r("div",_n,[e("span",bn,s(l.type),1)])):V("",!0)],10,mn)}),128))])),t.value?(i(),r("div",Cn,[b(n(x),{icon:"carbon:loading",class:"loading-icon"}),k(" "+s(n(o)("common.loading")),1)])):V("",!0),!t.value&&g.length===0?(i(),r("div",$n,[b(n(x),{icon:"carbon:bot",class:"empty-icon"}),e("p",null,s(n(o)("config.modelConfig.noModel")),1)])):V("",!0),e("button",{class:"add-btn",onClick:te},[b(n(x),{icon:"carbon:add"}),k(" "+s(n(o)("config.modelConfig.createNew")),1)])]),h.value?(i(),r("div",wn,[e("div",kn,[e("h3",null,s(h.value.modelName),1),e("div",Sn,[e("button",{class:"action-btn primary",onClick:v},[b(n(x),{icon:"carbon:save"}),k(" "+s(n(o)("common.save")),1)]),e("button",{class:"action-btn danger",onClick:I},[b(n(x),{icon:"carbon:trash-can"}),k(" "+s(n(o)("common.delete")),1)])])]),e("div",Tn,[e("label",null,[k(s(n(o)("config.modelConfig.type"))+" ",1),a[15]||(a[15]=e("span",{class:"required"},"*",-1))]),b(xe,{modelValue:h.value.type,"onUpdate:modelValue":a[0]||(a[0]=l=>h.value.type=l),options:u.map(l=>({id:l,name:l})),placeholder:n(o)("config.modelConfig.typePlaceholder"),"dropdown-title":n(o)("config.modelConfig.typePlaceholder"),icon:"carbon:types"},null,8,["modelValue","options","placeholder","dropdown-title"])]),e("div",An,[e("label",null,[k(s(n(o)("config.modelConfig.baseUrl"))+" ",1),a[16]||(a[16]=e("span",{class:"required"},"*",-1))]),O(e("input",{type:"text","onUpdate:modelValue":a[1]||(a[1]=l=>h.value.baseUrl=l),placeholder:n(o)("config.modelConfig.baseUrlPlaceholder"),required:""},null,8,xn),[[K,h.value.baseUrl]])]),e("div",En,[e("label",null,[k(s(n(o)("config.modelConfig.apiKey"))+" ",1),a[17]||(a[17]=e("span",{class:"required"},"*",-1))]),O(e("input",{type:"text","onUpdate:modelValue":a[2]||(a[2]=l=>h.value.apiKey=l),placeholder:n(o)("config.modelConfig.apiKeyPlaceholder"),required:""},null,8,Mn),[[K,h.value.apiKey]])]),e("div",Un,[e("label",null,[k(s(n(o)("config.modelConfig.modelName"))+" ",1),a[18]||(a[18]=e("span",{class:"required"},"*",-1))]),O(e("input",{type:"text","onUpdate:modelValue":a[3]||(a[3]=l=>h.value.modelName=l),placeholder:n(o)("config.modelConfig.modelNamePlaceholder"),required:""},null,8,Vn),[[K,h.value.modelName]])]),e("div",Nn,[e("label",null,[k(s(n(o)("config.modelConfig.description"))+" ",1),a[19]||(a[19]=e("span",{class:"required"},"*",-1))]),O(e("textarea",{"onUpdate:modelValue":a[4]||(a[4]=l=>h.value.modelDescription=l),rows:"3",placeholder:n(o)("config.modelConfig.descriptionPlaceholder"),required:""},null,8,Pn),[[K,h.value.modelDescription]])])])):(i(),r("div",Bn,[b(n(x),{icon:"carbon:bot",class:"placeholder-icon"}),e("p",null,s(n(o)("config.modelConfig.selectModelHint")),1)]))]),b(pe,{modelValue:E.value,"onUpdate:modelValue":a[10]||(a[10]=l=>E.value=l),title:n(o)("config.modelConfig.newModel"),onConfirm:R},{default:Q(()=>[e("div",Fn,[e("div",Rn,[e("label",null,[k(s(n(o)("config.modelConfig.type"))+" ",1),a[20]||(a[20]=e("span",{class:"required"},"*",-1))]),b(xe,{modelValue:$.type,"onUpdate:modelValue":a[5]||(a[5]=l=>$.type=l),options:u.map(l=>({id:l,name:l})),placeholder:n(o)("config.modelConfig.typePlaceholder"),"dropdown-title":n(o)("config.modelConfig.typePlaceholder"),icon:"carbon:types"},null,8,["modelValue","options","placeholder","dropdown-title"])]),e("div",Dn,[e("label",null,[k(s(n(o)("config.modelConfig.baseUrl"))+" ",1),a[21]||(a[21]=e("span",{class:"required"},"*",-1))]),O(e("input",{type:"text","onUpdate:modelValue":a[6]||(a[6]=l=>$.baseUrl=l),placeholder:n(o)("config.modelConfig.baseUrlPlaceholder"),required:""},null,8,Ln),[[K,$.baseUrl]])]),e("div",In,[e("label",null,[k(s(n(o)("config.modelConfig.apiKey"))+" ",1),a[22]||(a[22]=e("span",{class:"required"},"*",-1))]),O(e("input",{type:"text","onUpdate:modelValue":a[7]||(a[7]=l=>$.apiKey=l),placeholder:n(o)("config.modelConfig.apiKeyPlaceholder"),required:""},null,8,On),[[K,$.apiKey]])]),e("div",qn,[e("label",null,[k(s(n(o)("config.modelConfig.modelName"))+" ",1),a[23]||(a[23]=e("span",{class:"required"},"*",-1))]),O(e("input",{type:"text","onUpdate:modelValue":a[8]||(a[8]=l=>$.modelName=l),placeholder:n(o)("config.modelConfig.modelNamePlaceholder"),required:""},null,8,jn),[[K,$.modelName]])]),e("div",Gn,[e("label",null,[k(s(n(o)("config.modelConfig.description"))+" ",1),a[24]||(a[24]=e("span",{class:"required"},"*",-1))]),O(e("textarea",{"onUpdate:modelValue":a[9]||(a[9]=l=>$.modelDescription=l),rows:"3",placeholder:n(o)("config.modelConfig.descriptionPlaceholder"),required:""},null,8,Kn),[[K,$.modelDescription]])])])]),_:1},8,["modelValue","title"]),b(pe,{modelValue:U.value,"onUpdate:modelValue":a[12]||(a[12]=l=>U.value=l),title:"删除确认"},{footer:Q(()=>[e("button",{class:"cancel-btn",onClick:a[11]||(a[11]=l=>U.value=!1)},s(n(o)("common.cancel")),1),e("button",{class:"confirm-btn danger",onClick:Z},s(n(o)("common.delete")),1)]),default:Q(()=>{var l;return[e("div",Jn,[b(n(x),{icon:"carbon:warning",class:"warning-icon"}),e("p",null,[k(s(n(o)("config.modelConfig.deleteConfirmText"))+" ",1),e("strong",null,s((l=h.value)==null?void 0:l.modelName),1),k(" "+s(n(o)("common.confirm"))+"？",1)]),e("p",zn,s(n(o)("config.modelConfig.deleteWarning")),1)])]}),_:1},8,["modelValue"]),m.value?(i(),r("div",{key:0,class:"error-toast",onClick:a[13]||(a[13]=l=>m.value="")},[b(n(x),{icon:"carbon:error"}),k(" "+s(m.value),1)])):V("",!0),C.value?(i(),r("div",{key:1,class:"success-toast",onClick:a[14]||(a[14]=l=>C.value="")},[b(n(x),{icon:"carbon:checkmark"}),k(" "+s(C.value),1)])):V("",!0)]))}}),Xn=ce(Hn,[["__scopeId","data-v-e7941263"]]);class me{static async handleResponse(o){if(!o.ok)try{const t=await o.json();throw new Error(t.message||`API request failed: ${o.status}`)}catch{throw new Error(`API request failed: ${o.status} ${o.statusText}`)}return o}static async getAllNamespaces(){try{const o=await fetch(this.BASE_URL);return await(await this.handleResponse(o)).json()}catch(o){throw console.error("Failed to get Namespace list:",o),o}}static async getAllCodes(){try{const o=await fetch(`${this.BASE_URL}/codes`);return await(await this.handleResponse(o)).json()}catch(o){throw console.error("Failed to get Namespace codes list:",o),o}}static async getNamespaceById(o){try{const t=await fetch(`${this.BASE_URL}/${o}`);return await(await this.handleResponse(t)).json()}catch(t){throw console.error(`Failed to get Namespace[${o}] details:`,t),t}}static async getNamespaceByCode(o){try{const t=await fetch(`${this.BASE_URL}/code/${o}`);return await(await this.handleResponse(t)).json()}catch(t){throw console.error(`Failed to get Namespace[${o}] details:`,t),t}}static async createNamespace(o){try{const t=await fetch(this.BASE_URL,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});return await(await this.handleResponse(t)).json()}catch(t){throw console.error("Failed to create Namespace:",t),t}}static async updateNamespace(o,t){try{const m=await fetch(`${this.BASE_URL}/${o}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});return await(await this.handleResponse(m)).json()}catch(m){throw console.error(`Failed to update Namespace[${o}]:`,m),m}}static async deleteNamespace(o){try{const t=await fetch(`${this.BASE_URL}/${o}`,{method:"DELETE"});if(t.status===400)throw new Error("Cannot delete default Namespace");await this.handleResponse(t)}catch(t){throw console.error(`Failed to delete Namespace[${o}]:`,t),t}}}fe(me,"BASE_URL","/api/namespaces");const Yn={class:"config-panel"},Wn={class:"panel-header"},Qn={class:"panel-actions"},Zn=["disabled"],ea={class:"namespace-layout"},oa={class:"namespace-list"},ta={class:"list-header"},sa={class:"namespace-count"},na={key:0,class:"namespaces-container"},aa=["onClick"],la={class:"namespace-card-header"},ia={class:"namespace-name"},ca={class:"namespace-desc"},ra={class:"namespace-code"},da={class:"namespace-tag"},ua={key:1,class:"loading-state"},pa={key:2,class:"empty-state"},ga={key:0,class:"namespace-detail"},fa={class:"detail-header"},ma={class:"detail-actions"},va={class:"form-item"},ha=["placeholder"],ya={class:"form-item"},_a=["placeholder"],ba={class:"form-item"},Ca=["placeholder"],$a={key:1,class:"no-selection"},wa={class:"modal-form"},ka={class:"form-item"},Sa=["placeholder"],Ta={class:"form-item"},Aa=["placeholder"],xa={class:"form-item"},Ea=["placeholder"],Ma={class:"delete-confirm"},Ua={class:"warning-text"},Va=re({__name:"namespaceConfig",setup(j){const{t:o}=ve(),t=P(!1),m=P(""),C=P(""),g=ne([]),u=P(null),h=P(!1),E=P(!1),U=ne({name:"",code:"",description:""}),$=(F,c)=>{c==="success"?(C.value=F,setTimeout(()=>{C.value=""},3e3)):(m.value=F,setTimeout(()=>{m.value=""},5e3))},M=async()=>{t.value=!0;try{const c=(await me.getAllNamespaces()).map(a=>({...a}));g.splice(0,g.length,...c),c.length>0&&await J(c[0])}catch(F){console.error("加载数据失败:",F),$(o("config.namespaceConfig.loadDataFailed")+": "+F.message,"error")}finally{t.value=!1}},J=async F=>{try{const c=await me.getNamespaceById(F.id);u.value={...c}}catch(c){console.error("加载Namespace详情失败:",c),$(o("config.namespaceConfig.loadDetailsFailed")+": "+c.message,"error"),u.value={...F}}},W=()=>{U.name="",U.code="",U.description="",h.value=!0},te=async()=>{if(!U.name.trim()||!U.code.trim()||!U.description.trim()){$(o("config.namespaceConfig.requiredFields"),"error");return}try{const F={name:U.name.trim(),code:U.code.trim(),description:U.description.trim()},c=await me.createNamespace(F);g.push(c),u.value=c,h.value=!1,$(o("config.namespaceConfig.createSuccess"),"success")}catch(F){$(o("config.namespaceConfig.createFailed")+": "+F.message,"error")}},R=async()=>{if(u.value){if(!u.value.name.trim()||!u.value.code.trim()||!u.value.description.trim()){$(o("config.namespaceConfig.requiredFields"),"error");return}try{const F=await me.updateNamespace(u.value.id,u.value),c=g.findIndex(a=>a.id===F.id);c!==-1&&(g[c]=F),u.value=F,$(o("config.namespaceConfig.saveSuccess"),"success")}catch(F){$(o("config.namespaceConfig.saveFailed")+": "+F.message,"error")}}},v=()=>{E.value=!0},I=async()=>{if(u.value)try{await me.deleteNamespace(u.value.id);const F=g.findIndex(c=>c.id===u.value.id);F!==-1&&g.splice(F,1),u.value=g.length>0?g[0]:null,E.value=!1,$(o("config.namespaceConfig.deleteSuccess"),"success")}catch(F){$(o("config.namespaceConfig.deleteFailed")+": "+F.message,"error")}},Z=()=>{$(o("config.namespaceConfig.importNotImplemented"),"error")},G=()=>{u.value&&$(o("config.namespaceConfig.exportNotImplemented"),"error")};return _e(()=>{M()}),(F,c)=>(i(),r("div",Yn,[e("div",Wn,[e("h2",null,s(n(o)("config.namespaceConfig.title")),1),e("div",Qn,[e("button",{class:"action-btn",onClick:Z},[b(n(x),{icon:"carbon:upload"}),k(" "+s(n(o)("config.namespaceConfig.import")),1)]),e("button",{class:"action-btn",onClick:G,disabled:!u.value},[b(n(x),{icon:"carbon:download"}),k(" "+s(n(o)("config.namespaceConfig.export")),1)],8,Zn)])]),e("div",ea,[e("div",oa,[e("div",ta,[e("h3",null,s(n(o)("config.namespaceConfig.configuredNamespaces")),1),e("span",sa,"("+s(g.length)+")",1)]),t.value?V("",!0):(i(),r("div",na,[(i(!0),r(X,null,Y(g,a=>{var l;return i(),r("div",{key:a.id,class:oe(["namespace-card",{active:((l=u.value)==null?void 0:l.id)===a.id}]),onClick:y=>J(a)},[e("div",la,[e("span",ia,s(a.name),1),b(n(x),{icon:"carbon:chevron-right"})]),e("p",ca,s(a.description),1),e("div",ra,[e("span",da,s(a.code),1)])],10,aa)}),128))])),t.value?(i(),r("div",ua,[b(n(x),{icon:"carbon:loading",class:"loading-icon"}),k(" "+s(n(o)("common.loading")),1)])):V("",!0),!t.value&&g.length===0?(i(),r("div",pa,[b(n(x),{icon:"carbon:folder",class:"empty-icon"}),e("p",null,s(n(o)("config.namespaceConfig.noNamespace")),1)])):V("",!0),e("button",{class:"add-btn",onClick:W},[b(n(x),{icon:"carbon:add"}),k(" "+s(n(o)("config.namespaceConfig.createNew")),1)])]),u.value?(i(),r("div",ga,[e("div",fa,[e("h3",null,s(u.value.name),1),e("div",ma,[e("button",{class:"action-btn primary",onClick:R},[b(n(x),{icon:"carbon:save"}),k(" "+s(n(o)("common.save")),1)]),e("button",{class:"action-btn danger",onClick:v},[b(n(x),{icon:"carbon:trash-can"}),k(" "+s(n(o)("common.delete")),1)])])]),e("div",va,[e("label",null,[k(s(n(o)("config.namespaceConfig.name"))+" ",1),c[11]||(c[11]=e("span",{class:"required"},"*",-1))]),O(e("input",{type:"text","onUpdate:modelValue":c[0]||(c[0]=a=>u.value.name=a),placeholder:n(o)("config.namespaceConfig.namePlaceholder"),required:""},null,8,ha),[[K,u.value.name]])]),e("div",ya,[e("label",null,[k(s(n(o)("config.namespaceConfig.code"))+" ",1),c[12]||(c[12]=e("span",{class:"required"},"*",-1))]),O(e("input",{type:"text","onUpdate:modelValue":c[1]||(c[1]=a=>u.value.code=a),placeholder:n(o)("config.namespaceConfig.codePlaceholder"),required:""},null,8,_a),[[K,u.value.code]])]),e("div",ba,[e("label",null,[k(s(n(o)("config.namespaceConfig.description"))+" ",1),c[13]||(c[13]=e("span",{class:"required"},"*",-1))]),O(e("textarea",{"onUpdate:modelValue":c[2]||(c[2]=a=>u.value.description=a),rows:"3",placeholder:n(o)("config.namespaceConfig.descriptionPlaceholder"),required:""},null,8,Ca),[[K,u.value.description]])])])):(i(),r("div",$a,[b(n(x),{icon:"carbon:folder",class:"placeholder-icon"}),e("p",null,s(n(o)("config.namespaceConfig.selectNamespaceHint")),1)]))]),b(pe,{modelValue:h.value,"onUpdate:modelValue":c[6]||(c[6]=a=>h.value=a),title:n(o)("config.namespaceConfig.newNamespace"),onConfirm:te},{default:Q(()=>[e("div",wa,[e("div",ka,[e("label",null,[k(s(n(o)("config.namespaceConfig.name"))+" ",1),c[14]||(c[14]=e("span",{class:"required"},"*",-1))]),O(e("input",{type:"text","onUpdate:modelValue":c[3]||(c[3]=a=>U.name=a),placeholder:n(o)("config.namespaceConfig.namePlaceholder"),required:""},null,8,Sa),[[K,U.name]])]),e("div",Ta,[e("label",null,[k(s(n(o)("config.namespaceConfig.code"))+" ",1),c[15]||(c[15]=e("span",{class:"required"},"*",-1))]),O(e("input",{type:"text","onUpdate:modelValue":c[4]||(c[4]=a=>U.code=a),placeholder:n(o)("config.namespaceConfig.codePlaceholder"),required:""},null,8,Aa),[[K,U.code]])]),e("div",xa,[e("label",null,[k(s(n(o)("config.namespaceConfig.description"))+" ",1),c[16]||(c[16]=e("span",{class:"required"},"*",-1))]),O(e("textarea",{"onUpdate:modelValue":c[5]||(c[5]=a=>U.description=a),rows:"3",placeholder:n(o)("config.namespaceConfig.descriptionPlaceholder"),required:""},null,8,Ea),[[K,U.description]])])])]),_:1},8,["modelValue","title"]),b(pe,{modelValue:E.value,"onUpdate:modelValue":c[8]||(c[8]=a=>E.value=a),title:"删除确认"},{footer:Q(()=>[e("button",{class:"cancel-btn",onClick:c[7]||(c[7]=a=>E.value=!1)},s(n(o)("common.cancel")),1),e("button",{class:"confirm-btn danger",onClick:I},s(n(o)("common.delete")),1)]),default:Q(()=>{var a;return[e("div",Ma,[b(n(x),{icon:"carbon:warning",class:"warning-icon"}),e("p",null,[k(s(n(o)("config.namespaceConfig.deleteConfirmText"))+" ",1),e("strong",null,s((a=u.value)==null?void 0:a.name),1),k(" "+s(n(o)("common.confirm"))+"？",1)]),e("p",Ua,s(n(o)("config.namespaceConfig.deleteWarning")),1)])]}),_:1},8,["modelValue"]),m.value?(i(),r("div",{key:0,class:"error-toast",onClick:c[9]||(c[9]=a=>m.value="")},[b(n(x),{icon:"carbon:error"}),k(" "+s(m.value),1)])):V("",!0),C.value?(i(),r("div",{key:1,class:"success-toast",onClick:c[10]||(c[10]=a=>C.value="")},[b(n(x),{icon:"carbon:checkmark"}),k(" "+s(C.value),1)])):V("",!0)]))}}),Na=ce(Va,[["__scopeId","data-v-730733a8"]]);class Ce{static async getAllMcpServers(){const o=await fetch(`${this.BASE_URL}/list`);if(!o.ok)throw new Error(`Failed to get MCP server list: ${o.status}`);return await o.json()}static async addMcpServer(o){try{const t=await fetch(`${this.BASE_URL}/add`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});if(!t.ok)throw new Error(`Failed to add MCP server: ${t.status}`);return{success:!0,message:"Successfully added MCP server"}}catch(t){return console.error("Failed to add MCP server:",t),{success:!1,message:t instanceof Error?t.message:"Failed to add, please retry"}}}static async removeMcpServer(o){try{const t=await fetch(`${this.BASE_URL}/remove?id=${o}`);if(!t.ok)throw new Error(`Failed to delete MCP server: ${t.status}`);return{success:!0,message:"Successfully deleted MCP server"}}catch(t){return console.error(`Failed to delete MCP server[${o}]:`,t),{success:!1,message:t instanceof Error?t.message:"Failed to delete, please retry"}}}}fe(Ce,"BASE_URL","/api/mcp");const Pa={class:"mcp-config-panel"},Ba={class:"mcp-header"},Fa={class:"header-left"},Ra={class:"mcp-stats"},Da={class:"stat-item"},La={class:"stat-value"},Ia={class:"header-right"},Oa={class:"search-box"},qa={key:0,class:"loading-container"},ja={key:1,class:"mcp-layout"},Ga={class:"mcp-table-container"},Ka={key:0,class:"empty-state"},Ja={class:"empty-state-text"},za={key:1,class:"mcp-table-wrapper"},Ha={class:"mcp-table"},Xa={class:"mcp-id"},Ya={class:"mcp-server-name"},Wa={class:"server-name-content"},Qa={class:"mcp-connection-type"},Za={class:"mcp-config"},el=["title"],ol={class:"mcp-actions"},tl=["onClick","disabled"],sl={class:"add-mcp-container"},nl={class:"mcp-form"},al={class:"mcp-form-group"},ll={class:"connection-type-options"},il={class:"connection-type-option"},cl={class:"connection-type-option"},rl={class:"mcp-form-group"},dl=["placeholder"],ul={class:"mcp-form-actions"},pl=["disabled"],gl=["disabled"],fl=re({__name:"mcpConfig",setup(j){const{t:o}=ve(),t=P(!1),m=P([]),C=P(""),g=ne({connectionType:"STUDIO",configJson:""}),u=ne({show:!1,text:"",type:"success"}),h=ae(()=>g.configJson.trim().length>0),E=ae(()=>{if(!C.value.trim())return m.value;const R=C.value.toLowerCase();return m.value.filter(v=>v.mcpServerName.toLowerCase().includes(R)||v.connectionType.toLowerCase().includes(R)||v.connectionConfig.toLowerCase().includes(R))}),U=R=>R?R.length>50?R.substring(0,50)+"...":R:"",$=(R,v="success")=>{u.text=R,u.type=v,u.show=!0,setTimeout(()=>{u.show=!1},3e3)},M=async()=>{try{t.value=!0,m.value=await Ce.getAllMcpServers()}catch(R){console.error("加载MCP服务器列表失败:",R),$("加载MCP服务器列表失败","error")}finally{t.value=!1}},J=async()=>{if(!h.value){$(o("config.mcpConfig.configRequired"),"error");return}try{JSON.parse(g.configJson)}catch{$(o("config.mcpConfig.invalidJson"),"error");return}try{t.value=!0;const R={connectionType:g.connectionType,configJson:g.configJson},v=await Ce.addMcpServer(R);v.success?($("添加MCP服务器成功"),te(),await M()):$(v.message||o("config.mcpConfig.addFailed"),"error")}catch(R){console.error("添加MCP服务器失败:",R),$(o("config.mcpConfig.addFailed"),"error")}finally{t.value=!1}},W=async R=>{if(confirm("确定要删除这个MCP服务器配置吗？此操作不可恢复。"))try{t.value=!0;const v=await Ce.removeMcpServer(R);v.success?($("删除MCP服务器成功"),await M()):$(v.message||o("config.mcpConfig.deleteFailed"),"error")}catch(v){console.error("删除MCP服务器失败:",v),$(o("config.mcpConfig.deleteFailed"),"error")}finally{t.value=!1}},te=()=>{g.connectionType="STUDIO",g.configJson=""};return _e(()=>{M()}),(R,v)=>(i(),r("div",Pa,[e("div",Ba,[e("div",Fa,[v[5]||(v[5]=e("h2",null,"MCP配置",-1)),e("div",Ra,[e("span",Da,[v[4]||(v[4]=e("span",{class:"stat-label"},"总服务器:",-1)),e("span",La,s(m.value.length),1)])])]),e("div",Ia,[e("div",Oa,[O(e("input",{"onUpdate:modelValue":v[0]||(v[0]=I=>C.value=I),type:"text",placeholder:"搜索MCP服务器...",class:"search-input"},null,512),[[K,C.value]]),v[6]||(v[6]=e("span",{class:"search-icon"},"🔍",-1))])])]),t.value?(i(),r("div",qa,v[7]||(v[7]=[e("div",{class:"loading-spinner"},null,-1),e("p",null,"正在加载MCP服务器...",-1)]))):(i(),r("div",ja,[e("div",Ga,[v[11]||(v[11]=e("h3",{class:"section-title"},"已配置的MCP服务器",-1)),E.value.length===0?(i(),r("div",Ka,[v[8]||(v[8]=e("div",{class:"empty-state-icon"},"📂",-1)),e("div",Ja,s(C.value?"未找到匹配的MCP服务器":"暂无MCP服务器配置"),1)])):(i(),r("div",za,[e("table",Ha,[v[10]||(v[10]=e("thead",null,[e("tr",null,[e("th",null,"ID"),e("th",null,"服务器名称"),e("th",null,"连接类型"),e("th",null,"连接配置"),e("th",null,"操作")])],-1)),e("tbody",null,[(i(!0),r(X,null,Y(E.value,I=>(i(),r("tr",{key:I.id,class:"mcp-row"},[e("td",Xa,s(I.id),1),e("td",Ya,[e("div",Wa,[v[9]||(v[9]=e("span",{class:"server-icon"},"🔌",-1)),k(" "+s(I.mcpServerName),1)])]),e("td",Qa,[e("span",{class:oe(["connection-type-badge",I.connectionType.toLowerCase()])},s(I.connectionType),3)]),e("td",Za,[e("div",{class:"config-preview",title:I.connectionConfig},s(U(I.connectionConfig)),9,el)]),e("td",ol,[e("button",{onClick:Z=>W(I.id),class:"action-btn delete-btn",disabled:t.value}," 删除 ",8,tl)])]))),128))])])]))]),e("div",sl,[v[16]||(v[16]=e("div",{class:"add-mcp-header"},[e("h3",{class:"add-mcp-title"},"添加MCP服务器")],-1)),e("div",nl,[e("div",al,[v[14]||(v[14]=e("label",{class:"form-label"},"连接类型：",-1)),e("div",ll,[e("div",il,[O(e("input",{type:"radio",id:"mcp-connection-type-studio","onUpdate:modelValue":v[1]||(v[1]=I=>g.connectionType=I),value:"STUDIO"},null,512),[[Ae,g.connectionType]]),v[12]||(v[12]=e("label",{for:"mcp-connection-type-studio",class:"radio-label"},[e("span",{class:"radio-title"},"STUDIO"),e("span",{class:"connection-type-desc"},"本地mcp server，目前市面上主流的是这个")],-1))]),e("div",cl,[O(e("input",{type:"radio",id:"mcp-connection-type-sse","onUpdate:modelValue":v[2]||(v[2]=I=>g.connectionType=I),value:"SSE"},null,512),[[Ae,g.connectionType]]),v[13]||(v[13]=e("label",{for:"mcp-connection-type-sse",class:"radio-label"},[e("span",{class:"radio-title"},"SSE"),e("span",{class:"connection-type-desc"},"通过http server等提供的，目前网络上比较少见")],-1))])])]),e("div",rl,[v[15]||(v[15]=e("label",{class:"form-label"},"mcp json配置：",-1)),O(e("textarea",{"onUpdate:modelValue":v[3]||(v[3]=I=>g.configJson=I),placeholder:n(o)("config.mcpConfig.configJsonPlaceholder"),class:"config-textarea",rows:"6"},null,8,dl),[[K,g.configJson]])]),e("div",ul,[e("button",{onClick:J,class:"action-btn add-btn",disabled:t.value},s(n(o)("common.add")),9,pl),e("button",{onClick:te,class:"action-btn reset-btn",disabled:t.value},s(n(o)("common.reset")),9,gl)])]),v[17]||(v[17]=Re('<div class="mcp-form-instructions" data-v-0ed0ce1e><h4 data-v-0ed0ce1e>使用说明：</h4><ol data-v-0ed0ce1e><li data-v-0ed0ce1e>找到你要用的mcp server的配置json： <ul class="indented-list" data-v-0ed0ce1e><li data-v-0ed0ce1e><strong data-v-0ed0ce1e>本地(STDIO)</strong>：可以在<a href="https://mcp.so" target="_blank" rel="noopener" data-v-0ed0ce1e>mcp.so</a>上找到，需要你有Node.js环境并理解你要配置的json里面的每一个项，做对应调整比如配置ak</li><li data-v-0ed0ce1e><strong data-v-0ed0ce1e>远程服务(SSE)</strong>：<a href="https://mcp.higress.ai/" target="_blank" rel="noopener" data-v-0ed0ce1e>mcp.higress.ai/</a>上可以找到，有SSE和STREAMING两种，目前SSE协议更完备一些</li></ul></li><li data-v-0ed0ce1e>将json配置复制到上面的输入框，本地选STUDIO，远程选STREAMING或SSE，提交</li><li data-v-0ed0ce1e>这样mcp tools就注册成功了。</li><li data-v-0ed0ce1e>然后需要在Agent配置里面，新建一个agent，然后增加指定你刚才添加的mcp tools，这样可以极大减少冲突，增强tools被agent选择的准确性</li></ol></div>',1))])])),b($e,{name:"message-fade"},{default:Q(()=>[u.show?(i(),r("div",{key:0,class:oe(["message-toast",u.type])},s(u.text),3)):V("",!0)]),_:1})]))}}),ml=ce(fl,[["__scopeId","data-v-0ed0ce1e"]]),vl={class:"config-container"},hl={class:"config-header"},yl={class:"header-actions"},_l={class:"config-content"},bl={class:"config-nav"},Cl=["onClick"],$l={class:"config-details"},wl=re({__name:"index",setup(j){const{t:o}=ve(),t=P("basic"),m=ae(()=>[{key:"basic",label:o("config.categories.basic"),icon:"carbon:settings"},{key:"agent",label:o("config.categories.agent"),icon:"carbon:bot"},{key:"model",label:o("config.categories.model"),icon:"carbon:build-image"},{key:"namespace",label:o("config.categories.namespace"),icon:"carbon:folder"},{key:"mcp",label:o("config.categories.mcp"),icon:"carbon:tool-box"}]);return(C,g)=>(i(),r("div",vl,[e("div",hl,[e("div",yl,[e("button",{class:"action-btn",onClick:g[0]||(g[0]=u=>C.$router.push("/"))},[b(n(x),{icon:"carbon:arrow-left"}),k(" "+s(C.$t("backHome")),1)]),b(De)])]),e("div",_l,[e("nav",bl,[(i(!0),r(X,null,Y(m.value,(u,h)=>(i(),r("div",{key:h,class:oe(["nav-item",{active:t.value===u.key}]),onClick:E=>t.value=u.key},[b(n(x),{icon:u.icon,width:"20"},null,8,["icon"]),e("span",null,s(u.label),1)],10,Cl))),128))]),e("div",$l,[t.value==="basic"?(i(),ie(ft,{key:0})):V("",!0),t.value==="agent"?(i(),ie(Hs,{key:1})):V("",!0),t.value==="model"?(i(),ie(Xn,{key:2})):V("",!0),t.value==="namespace"?(i(),ie(Na,{key:3})):V("",!0),t.value==="mcp"?(i(),ie(ml,{key:4})):V("",!0)])])]))}}),xl=ce(wl,[["__scopeId","data-v-04ec4b64"]]);export{xl as default};
